var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var c=a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var c,b=[];!(c=a.next()).done;)b.push(c.value);return b};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};
var numeric="undefined"===typeof exports?function(){}:exports;"undefined"!==typeof global&&(global.numeric=numeric);numeric.version="1.2.6";numeric.bench=function(a,c){var b,d;"undefined"===typeof c&&(c=15);var e=.5;for(b=new Date;;){for(d=e*=2;3<d;d-=4)a(),a(),a(),a();for(;0<d;)a(),d--;d=new Date;if(d-b>c)break}for(d=e;3<d;d-=4)a(),a(),a(),a();for(;0<d;)a(),d--;d=new Date;return 1E3*(3*e-1)/(d-b)};numeric._myIndexOf=function(a){var c=this.length,b;for(b=0;b<c;++b)if(this[b]===a)return b;return-1};
numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf;numeric.Function=Function;numeric.precision=4;numeric.largeArray=50;
numeric.prettyPrint=function(a){function c(a){if(0===a)return"0";if(isNaN(a))return"NaN";if(0>a)return"-"+c(-a);if(isFinite(a)){var b=Math.floor(Math.log(a)/Math.log(10));a=(a/Math.pow(10,b)).toPrecision(numeric.precision);10===parseFloat(a)&&(b++,a=(1).toPrecision(numeric.precision));return parseFloat(a).toString()+"e"+b.toString()}return"Infinity"}function b(a){if("undefined"===typeof a)return d.push(Array(numeric.precision+8).join(" ")),!1;if("string"===typeof a)return d.push('"'+a+'"'),!1;if("boolean"===
typeof a)return d.push(a.toString()),!1;if("number"===typeof a){var f=c(a);var e=a.toPrecision(numeric.precision);a=parseFloat(a.toString()).toString();a=[f,e,a,parseFloat(e).toString(),parseFloat(a).toString()];for(e=1;e<a.length;e++)a[e].length<f.length&&(f=a[e]);d.push(Array(numeric.precision+8-f.length).join(" ")+f);return!1}if(null===a)return d.push("null"),!1;if("function"===typeof a){d.push(a.toString());f=!1;for(e in a)a.hasOwnProperty(e)&&(f?d.push(",\n"):d.push("\n{"),f=!0,d.push(e),d.push(": \n"),
b(a[e]));f&&d.push("}\n");return!0}if(a instanceof Array){if(a.length>numeric.largeArray)return d.push("...Large Array..."),!0;f=!1;d.push("[");for(e=0;e<a.length;e++)0<e&&(d.push(","),f&&d.push("\n ")),f=b(a[e]);d.push("]");return!0}d.push("{");f=!1;for(e in a)a.hasOwnProperty(e)&&(f&&d.push(",\n"),f=!0,d.push(e),d.push(": \n"),b(a[e]));d.push("}");return!0}var d=[];b(a);return d.join("")};
numeric.parseDate=function(a){function c(a){if("string"===typeof a)return Date.parse(a.replace(/-/g,"/"));if(!(a instanceof Array))throw Error("parseDate: parameter must be arrays of strings");var b=[],e;for(e=0;e<a.length;e++)b[e]=c(a[e]);return b}return c(a)};numeric.parseFloat=function(a){function c(a){if("string"===typeof a)return parseFloat(a);if(!(a instanceof Array))throw Error("parseFloat: parameter must be arrays of strings");var b=[],e;for(e=0;e<a.length;e++)b[e]=c(a[e]);return b}return c(a)};
numeric.parseCSV=function(a){a=a.split("\n");var c,b,d=[],e=/(([^'",]*)|('[^']*')|("[^"]*")),/g,f=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,g=0;for(b=0;b<a.length;b++)if(""!==a[b]){var l=(a[b]+",").match(e);if(0<l.length){d[g]=[];for(c=0;c<l.length;c++){var h=l[c];h=h.substr(0,h.length-1);f.test(h)?d[g][c]=parseFloat(h):d[g][c]=h}g++}}return d};
numeric.toCSV=function(a){for(var c=numeric.dim(a),b,d=c[0],e=c[1],f,g=[],c=0;c<d;c++){f=[];for(b=0;b<e;b++)f[b]=a[c][b].toString();g[c]=f.join(", ")}return g.join("\n")+"\n"};numeric.getURL=function(a){var c=new XMLHttpRequest;c.open("GET",a,!1);c.send();return c};
numeric.imageURL=function(a){function c(a,b,c){"undefined"===typeof b&&(b=0);"undefined"===typeof c&&(c=a.length);var d=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,
1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,
1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,
1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,
628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,
3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],f=-1,e;for(e=b;e<c;e++)b=(f^a[e])&255,f=f>>>8^d[b];return f^-1}var b=a[0].length,d=a[0][0].length,e,f,g,l=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,d>>24&255,d>>16&
255,d>>8&255,d&255,b>>24&255,b>>16&255,b>>8&255,b&255,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];var h=c(l,12,29);l[29]=h>>24&255;l[30]=h>>16&255;l[31]=h>>8&255;l[32]=h&255;h=1;for(f=e=0;f<b;f++){f<b-1?l.push(0):l.push(1);var k=3*d+1+(0===f)&255;var n=3*d+1+(0===f)>>8&255;l.push(k);l.push(n);l.push(~k&255);l.push(~n&255);0===f&&l.push(0);for(g=0;g<d;g++)for(n=0;3>n;n++)k=a[n][f][g],k=255<k?255:0>k?0:Math.round(k),h=(h+k)%65521,e=(e+h)%65521,l.push(k);l.push(0)}a=(e<<16)+h;l.push(a>>24&255);
l.push(a>>16&255);l.push(a>>8&255);l.push(a&255);a=l.length-41;l[33]=a>>24&255;l[34]=a>>16&255;l[35]=a>>8&255;l[36]=a&255;h=c(l,37);l.push(h>>24&255);l.push(h>>16&255);l.push(h>>8&255);l.push(h&255);l.push(0);l.push(0);l.push(0);l.push(0);l.push(73);l.push(69);l.push(78);l.push(68);l.push(174);l.push(66);l.push(96);l.push(130);return"data:image/png;base64,"+function(a){var b=a.length,c,d="";for(c=0;c<b;c+=3){var f=a[c];var e=a[c+1];var g=a[c+2];var h=f>>2;f=((f&3)<<4)+(e>>4);e=((e&15)<<2)+(g>>6);
g&=63;c+1>=b?e=g=64:c+2>=b&&(g=64);d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g)}return d}(l)};numeric._dim=function(a){for(var c=[];"object"===typeof a;)c.push(a.length),a=a[0];return c};
numeric.dim=function(a){if("object"===typeof a){var c=a[0];if("object"===typeof c){var b=c[0];return"object"===typeof b?numeric._dim(a):[a.length,c.length]}return[a.length]}return[]};numeric.flatten=function(a,c,b){if("object"!==typeof a)return a;"undefined"===typeof b&&(b=0);"undefined"===typeof c&&(c=numeric.dim(a));if(b===c.length-1)return a;var d,e=a.length,f=[];for(d=0;d<e;++d)f=f.concat(numeric.flatten(a[d],c,b+1));return f};
numeric._reshape=function(a,c,b){if(b===c.length-1)return a.splice(0,c[b]);var d,e=c[b],f=Array(e);for(d=0;d<e;++d)f[d]=numeric._reshape(a,c,b+1);return f};numeric.reshape=function(a,c,b){return numeric._reshape(numeric.flatten(a),c,0)};
numeric.concat=function(a,c,b,d,e){"undefined"===typeof e&&(e=0);"undefined"===typeof b&&(b=0);"undefined"===typeof d&&(d=numeric.dim(a));0>b&&(b=d.length+b);if(b===e)return a.concat(c);var f=d[e];var g=Array(f);for(--f;0<=f;--f)g[f]=numeric.concat(a[f],c[f],b,d,e+1);return g};numeric.stack=function(a,c){var b,d=a[0],e=a.length;for(b=1;b<e;b++)d=numeric.concat(d,a[b],c);return d};numeric.hstack=function(a){return numeric.stack(a,-1)};numeric.vstack=function(a){return numeric.stack(a,-2)};
numeric.dstack=function(a){return numeric.stack(a,-3)};numeric.same=function same(c,b){var d;if(!(c instanceof Array&&b instanceof Array))return!1;var e=c.length;if(e!==b.length)return!1;for(d=0;d<e;d++)if(c[d]!==b[d])if("object"===typeof c[d]){if(!same(c[d],b[d]))return!1}else return!1;return!0};numeric.empty=function(a,c){"undefined"===typeof c&&(c=0);var b=a[c],d=Array(b);if(0!==a.length){if(a.length-1===c)return d;for(--b;0<=b;b--)d[b]=numeric.empty(a,c+1);return d}};
numeric.rep=function(a,c,b){"undefined"===typeof b&&(b=0);var d=a[b],e=Array(d);if(0===a.length)return c;if(a.length-1===b){for(d-=2;0<=d;d-=2)e[d+1]=c,e[d]=c;-1===d&&(e[0]=c);return e}for(--d;0<=d;d--)e[d]=numeric.rep(a,c,b+1);return e};numeric.zeros=function(a){return numeric.rep(a,0)};numeric.ones=function(a){return numeric.rep(a,1)};
numeric.dotMMsmall=function(a,c){var b,d;var e=a.length;var f=c.length;var g=c[0].length;var l=Array(e);for(--e;0<=e;e--){var h=Array(g);var k=a[e];for(d=g-1;0<=d;d--){var n=k[f-1]*c[f-1][d];for(b=f-2;1<=b;b-=2){var p=b-1;n+=k[b]*c[b][d]+k[p]*c[p][d]}0===b&&(n+=k[0]*c[0][d]);h[d]=n}l[e]=h}return l};numeric._getCol=function(a,c,b){var d;for(d=a.length-1;0<d;--d)b[d]=a[d][c],--d,b[d]=a[d][c];0===d&&(b[0]=a[0][c])};
numeric.dotMMbig=function(a,c){var b=numeric._getCol,d=Array(c.length),e=a.length,f=c[0].length,g=Array(e),l=numeric.dotVV,h,k;--e;for(h=e;-1!==h;--h)g[h]=Array(f);--f;for(h=f;-1!==h;--h)for(b(c,h,d),k=e;-1!==k;--k)f=a[k],g[k][h]=l(f,d);return g};numeric.dotMV=function(a,c){for(var b=a.length,d=Array(b),e=numeric.dotVV,b=b-1;0<=b;b--)d[b]=e(a[b],c);return d};
numeric.dotVM=function(a,c){var b;var d=a.length;var e=c[0].length;var f=Array(e);for(b=e-1;0<=b;b--){var g=a[d-1]*c[d-1][b];for(e=d-2;1<=e;e-=2){var l=e-1;g+=a[e]*c[e][b]+a[l]*c[l][b]}0===e&&(g+=a[0]*c[0][b]);f[b]=g}return f};numeric.dotVV=function(a,c){var b=a.length;var d=a[b-1]*c[b-1];for(b-=2;1<=b;b-=2){var e=b-1;d+=a[b]*c[b]+a[e]*c[e]}0===b&&(d+=a[0]*c[0]);return d};
numeric.dot=function(a,c){var b=numeric.dim;switch(1E3*b(a).length+b(c).length){case 2002:return 10>c.length?numeric.dotMMsmall(a,c):numeric.dotMMbig(a,c);case 2001:return numeric.dotMV(a,c);case 1002:return numeric.dotVM(a,c);case 1001:return numeric.dotVV(a,c);case 1E3:return numeric.mulVS(a,c);case 1:return numeric.mulSV(a,c);case 0:return a*c;default:throw Error("numeric.dot only works on vectors and matrices");}};
numeric.outer=function(a,c){a=numeric.flatten(a);c=numeric.flatten(c);return numeric.dot(numeric.transpose([a]),[c])};numeric.inner=function(a,c){return"object"!==typeof a||"object"!==typeof c?numeric.mul(a,c):numeric.sum(numeric.add(a,c),-1)};
numeric.roll=function(a,c,b,d,e){"undefined"===typeof c&&(c=1);"undefined"===typeof b&&(b=-1);"undefined"===typeof d&&(d=numeric.dim(a));"undefined"===typeof e&&(e=0);0>b&&(b=d.length+b);if(e===b)return a.slice(d[e]-c).concat(a.slice(0,d[e]-c));var f,g=d[e],l=Array(g);for(f=0;f<g;++f)l[f]=numeric.roll(a[f],c,b,d,e+1);return l};
numeric.flip=function(a,c,b,d){"undefined"===typeof c&&(c=-1);"undefined"===typeof b&&(b=numeric.dim(a));"undefined"===typeof d&&(d=0);0>c&&(c=b.length+c);if(d===c){var e=a.slice();e.reverse();return e}var f,g=b[d];e=Array(g);for(f=0;f<g;++f)e[f]=numeric.flip(a[f],c,b,d+1);return e};numeric.fliplr=function(a){return numeric.flip(a,-1)};numeric.flipud=function(a){return numeric.flip(a,-2)};
numeric.rot90=function(a,c){"undefined"===typeof c&&(c=1);for(var b=0;b<c;b++)a=numeric.flipud(numeric.transpose(a));return a};numeric.kron=function(a,c){for(var b=numeric.dim(a),d=numeric.dim(c),e=b[0]*d[0],f=b[1]*d[1],g=numeric.rep([e,f],0),l=0;l<e;++l)for(var h=0;h<f;++h)g[l][h]=a[Math.floor(l/b[0])][Math.floor(h/d[1])]*c[l%b[0]][h%b[1]];return g};
numeric.diag=function(a){var c,b,d=a.length,e=Array(d);for(c=d-1;0<=c;c--){var f=Array(d);var g=c+2;for(b=d-1;b>=g;b-=2)f[b]=0,f[b-1]=0;b>c&&(f[b]=0);f[c]=a[c];for(b=c-1;1<=b;b-=2)f[b]=0,f[b-1]=0;0===b&&(f[0]=0);e[c]=f}return e};numeric.getDiag=function(a){for(var c=Math.min(a.length,a[0].length),b=Array(c),c=c-1;1<=c;--c)b[c]=a[c][c],--c,b[c]=a[c][c];0===c&&(b[0]=a[0][0]);return b};numeric.setDiag=function(a,c){for(var b=0;b<c.length;b++)a[b][b]=c[b]};
numeric.identity=function(a){return numeric.diag(numeric.rep([a],1))};numeric._broadcast=function(a,c,b){for(var d=0;d<b.length-c.length;d++)a=[a];return a};numeric.anonID=0;
numeric.pointwise=function(a,c,b){"undefined"===typeof a&&(a="");"undefined"===typeof c&&(c="");"undefined"===typeof b&&(b="binary");if("unary"===b)numeric["_anonymous"+numeric.anonID]=numeric._unary(a,c),a=Function("x",'if(typeof x !== "object") {\n    var i=0,k=0,z=Array(1);'+c+";\n    x=[x];"+a+";\n    return z[0];} else {\n    return numeric._foreach(x,numeric.dim(x),0,numeric._anonymous"+numeric.anonID+");\n}");else if("unary-inplace"===b)numeric["_anonymous"+numeric.anonID]=numeric._unaryeq(a,
c),a=Function("x",'if(typeof x !== "object") {\n    throw new Error("numeric: Cannot perform in-place operation on number");\n} else {\n    numeric._foreacheq(x,numeric.dim(x),0,numeric._anonymous'+numeric.anonID+");\n}");else if("binary"===b)numeric["_anonymous"+numeric.anonID]=numeric._binary(a,c),a=Function('var a,n=arguments.length,x=arguments[0],y,dim=numeric.dim;\nfor(a=1;a<n;++a) {\n    y = arguments[a];\n    if (typeof x === "object"\n    ||  typeof y === "object") {\n       x = numeric._broadcast(x, dim(x), dim(y));\n       y = numeric._broadcast(y, dim(y), dim(x));\n       x = numeric._biforeach(x,y,dim(x),dim(y),0,numeric._anonymous'+
numeric.anonID+");\n   } else {\n       var i=0,j=0,k=0,z=Array(1);"+c+";\n       x=[x];y=[y];"+a+";\n       x=z[0];\n   }\n}\nreturn x;");else if("binary-inplace"===b)numeric["_anonymous"+numeric.anonID]=numeric._binaryeq(a,c),a=Function('var a,n=arguments.length,x=arguments[0],y,dim=numeric.dim;\nif(typeof x !== "object") {\n    throw new Error("numeric: Cannot perform in-place operation on number");\n}\nfor(a=1;a<n;++a) {\n    y = arguments[a];\n    y = numeric._broadcast(y, dim(y), dim(x));\n    numeric._biforeacheq(x,y,dim(x),dim(y),0,numeric._anonymous'+
numeric.anonID+");\n}\nreturn x;");else throw Error('numeric: Unknown pointwise function type "'+b+'"');numeric.anonID++;return a};numeric._binary=function(a,c){return Function("x","y","_n","_m","var i,j,k,z=_n===1?Array(_m):Array(_n);\n"+c+";\nif(_n === 1) { for(j=_m-1;j>=0;--j) {i=0;k=j;"+a+"} } else \nif(_m === 1) { for(i=_n-1;i>=0;--i) {j=0;k=i;"+a+"} } else \n             { for(i=_n-1;i>=0;--i) {j=i;k=i;"+a+"} }\nreturn z;")};
numeric._binaryeq=function(a,c){return Function("x","y","_n","_m","var i,j,k;\n"+c+";\nif(_m === 1) { for(i=_n-1;i>=0;--i) {j=0;k=i;"+a+"} } else \n             { for(i=_n-1;i>=0;--i) {j=i;k=i;"+a+"} }\n")};numeric._unary=function(a,c){return Function("x","_n","var i,k,z=Array(_n);\n"+c+";\nfor(i=_n-1;i>=0;--i) {k=i;"+a+"}return z;")};numeric._unaryeq=function(a,c){return Function("x","_n","var i,k;\n"+c+";\nfor(i=_n-1;i>=0;--i) {k=i;"+a+"}")};
numeric._biforeacheq=function _biforeacheq(c,b,d,e,f,g){if(f===d.length-1)g(c,b,d[f],e[f]);else{var l=d[f];if(1===e[f])for(--l;0<=l;l--)_biforeacheq(c[l],b[0],d,e,f+1,g);else for(--l;0<=l;l--)_biforeacheq(c[l],b[l],d,e,f+1,g)}};
numeric._biforeach=function _biforeach(c,b,d,e,f,g){if(f===d.length-1)return g(c,b,d[f],e[f]);var l=d[f];var h=e[f],k=1===l?Array(h):Array(l);if(1===l)for(l=h-1;0<=l;--l)k[l]=_biforeach(c[0],b[l],d,e,f+1,g);else if(1===h)for(--l;0<=l;--l)k[l]=_biforeach(c[l],b[0],d,e,f+1,g);else for(--l;0<=l;--l)k[l]=_biforeach(c[l],b[l],d,e,f+1,g);return k};numeric._foreacheq=function _foreacheq(c,b,d,e){if(d===b.length-1)e(c,b[d]);else for(var f=b[d]-1;0<=f;f--)_foreacheq(c[f],b,d+1,e)};
numeric._foreach=function _foreach(c,b,d,e){if(d===b.length-1)return e(c,b[d]);var f=b[d];var g=Array(f);for(--f;0<=f;f--)g[f]=_foreach(c[f],b,d+1,e);return g};numeric._mapreduce=function(a,c){return Function("x","s","_n",c+"; for(var i=_n-1;i>=0;--i) { "+a+" }; return z;")};
numeric.mapreduce=function(a,c){numeric["_anonymous"+numeric.anonID]=numeric._mapreduce(a,c);var b=Function("x","a","s","k",'if(typeof x !== "object") { x = [x]; }\nif(typeof a === "undefined") { x = numeric.flatten(x); a=0; }\nif(typeof s === "undefined") { s = numeric.dim(x); }\nif(typeof k === "undefined") { k = 0; }\nif(a < 0) { a = numeric.dim(x).length+a; }return numeric._mapreduceeach(x,a,s,k,numeric._anonymous'+numeric.anonID+")");numeric.anonID++;return b};
numeric._mapreduceeach=function(a,c,b,d,e){if(c===d)return e(a,b.slice().splice(d+1),b[d]);var f=b[d];var g=Array(f);for(--f;0<=f;--f)g[f]=numeric._mapreduceeach(a[f],c,b,d+1,e);return g};numeric.ops1={neg:"-",not:"!",bnot:"~",bool:"!!",clone:""};numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};
numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="};numeric.mathfuns="abs acos asin atan ceil cos exp floor log round sin sqrt tan isNaN isFinite".split(" ");numeric.mathfuns2=["atan2","pow","max","min"];
(function(){var a;for(a=0;a<numeric.mathfuns2.length;++a){var c=numeric.mathfuns2[a];numeric.ops2[c]=c}for(a in numeric.ops2)if(numeric.ops2.hasOwnProperty(a)){c=numeric.ops2[a];var b="";if(-1!==numeric.myIndexOf.call(numeric.mathfuns2,a)){b="var "+c+" = Math."+c+";";var d=function(a,b,d){return a+" = "+c+"("+b+","+d+");"};var e=function(a,b){return a+" = "+c+"("+a+","+b+");"}}else d=function(a,b,d){return a+" = "+b+" "+c+" "+d+";"},e=numeric.opseq.hasOwnProperty(a+"eq")?function(a,b){return a+" "+
c+"= "+b+";"}:function(a,b){return a+" = "+a+" "+c+" "+b+";"};numeric[a]=numeric.pointwise(d("z[k]","x[i]","y[j]"),b,"binary");numeric[a+"eq"]=numeric.pointwise(e("x[k]","y[j]"),b,"binary-inplace");numeric[c]=numeric[a];numeric[c+"="]=numeric[a+"eq"]}for(a=0;a<numeric.mathfuns2.length;++a)c=numeric.mathfuns2[a],delete numeric.ops2[c];for(a=0;a<numeric.mathfuns.length;++a)c=numeric.mathfuns[a],numeric.ops1[c]=c;for(a in numeric.ops1)numeric.ops1.hasOwnProperty(a)&&(b="",c=numeric.ops1[a],-1!==numeric.myIndexOf.call(numeric.mathfuns,
a)&&Math.hasOwnProperty(c)&&(b="var "+c+" = Math."+c+";"),numeric[a]=numeric.pointwise("z[k] = "+c+"(x[i]);",b,"unary"),numeric[a+"eq"]=numeric.pointwise("x[k] = "+c+"(x[i]);",b,"unary-inplace"));for(a=0;a<numeric.mathfuns.length;++a)c=numeric.mathfuns[a],delete numeric.ops1[c]})();numeric.when=function(a,c,b){return numeric.bor(numeric.and(a,c),numeric.and(numeric.not(a),b))};numeric.clip=function(a,c,b){return numeric.min(numeric.max(a,c),b)};
numeric.saturate=function(a){return numeric.clip(a,0,1)};
numeric.reducers={any:["z = or(z, bool(x[i]));","var z=numeric.rep(s,false), or=numeric.or, bool=numeric.bool;"],all:["z=and(z,bool(x[i]));","var z=numeric.rep(s,true), and=numeric.and, bool=numeric.bool;"],sum:["z=add(z,x[i]);","var z=numeric.zeros(s), add=numeric.add;"],prod:["z=mul(z,x[i]);","var z=numeric.ones(s), mul=numeric.mul;"],mean:["z=add(z,div(x[i],x.length));","var z=numeric.zeros(s), add=numeric.add, div=numeric.div;"],norm1:["z=add(z,abs(x[i]))","var z=numeric.zeros(s), add=numeric.add, abs=numeric.abs;"],
norminf:["z=max(z,abs(x[i]));","var z=numeric.zeros(s), max=numeric.max, abs=numeric.abs;"],norm2Squared:["z=add(z,mul(x[i],x[i]));","var z=numeric.zeros(s), add=numeric.add, mul=numeric.mul;"],sup:["z=max(z,x[i]);","var z=numeric.rep(s,-Infinity), max=numeric.max;"],inf:["z=min(z,x[i]);","var z=numeric.rep(s,Infinity), min=numeric.min;"],arginf:["z=when(lt(x[i],v),i,z);v=min(x[i],v);","var z=numeric.zeros(s), v=numeric.rep(s,Infinity),lt=numeric.lt, when=numeric.when, min=numeric.min;"],argsup:["z=when(gt(x[i],v),i,z);v=max(x[i],v);",
"var z=numeric.zeros(s), v=numeric.rep(s,-Infinity),gt=numeric.gt, when=numeric.when, max=numeric.max;"]};(function(){var a;for(a in numeric.reducers)if(numeric.reducers.hasOwnProperty(a)){var c=numeric.reducers[a];numeric[a]=numeric.mapreduce(c[0],c[1])}})();numeric.variance=function(a,c){return numeric.sub(numeric.mean(numeric.pow(a,2),c),numeric.pow(numeric.mean(a,c),2))};numeric.std=function(a,c){return numeric.sqrt(numeric.variance(a,c))};
numeric._parseSlice=function(a,c){var b=/^(-?\d+)?:(-?\d+)?(:(-?\d+))?$/.exec(c),d="undefined"!==typeof b[4]?parseInt(b[4]):1,b={start:"undefined"!==typeof b[1]?parseInt(b[1]):0>d?a.length-1:0,stop:"undefined"!==typeof b[2]?parseInt(b[2]):0>d?0:a.length,step:d};b.start=0>b.start?a.length+b.start:b.start;b.stop=0>b.stop?a.length+b.stop:b.stop;return b};
numeric._slice=function(a,c){if("|"===c)return[a];if(":"===c)return a;if("number"===typeof c)return a[0>c?a.length+c:c];if("string"===typeof c){var b,d=numeric._parseSlice(a,c),e=[];for(b=d.start;(0>d.step?b>d.stop:b<d.stop)&&0<=b&&b<a.length;b+=d.step)e.push(a[b]);return e}};
numeric.slice=function(a,c,b){var d;"undefined"===typeof b&&(b=0);if("object"!==typeof c)return numeric.slice(a,[c],0);if(b===c.length-1)return numeric._slice(a,c[b]);if("|"===c[b])return[numeric.slice(a,c,b+1)];if("number"===typeof c[b])return numeric.slice(a[0>c[b]?a.length+c[b]:c[b]],c,b+1);if("string"===typeof c[b]){if("..."===c[b]){b=numeric.dim(a).length-c.length+1;c=c.splice(1);for(d=0;d<b;d++)c=[":"].concat(c);return numeric.slice(a,c,0)}var e=numeric._parseSlice(a,c[b]),f=[];for(d=e.start;(0>
e.step?d>e.stop:d<e.stop)&&0<=d&&d<a.length;d+=e.step)f.push(numeric.slice(a[d],c,b+1));return f}};numeric._sliceeq=function(a,c,b){"number"===typeof c&&(a[0>c?a.length+c:c]=b);if("string"===typeof c){var d,e=numeric._parseSlice(a,c);c=e.start;for(d=0;(0>e.step?c>e.stop:c<e.stop)&&0<=c&&c<a.length;c+=e.step,d++)a[c]="object"!==typeof b?b:1==b.length?b[0]:b[d]}};
numeric.sliceeq=function(a,c,b,d){var e;"undefined"===typeof d&&(d=0);"object"!==typeof c&&numeric.sliceeq(a,[c],b,0);d===c.length-1&&numeric._sliceeq(a,c[d],b);"number"===typeof c[d]&&numeric.sliceeq(a[0>c[d]?a.length+c[d]:c[d]],c,b,d+1);if("string"===typeof c[d])if("..."===c[d]){d=numeric.dim(a).length-c.length+1;c=c.splice(1);for(e=0;e<d;e++)c=[":"].concat(c);numeric.sliceeq(a,c,b,0)}else{var f,g=numeric._parseSlice(a,c[d]);e=g.start;for(f=0;(0>g.step?e>g.stop:e<g.stop)&&0<=e&&e<a.length;e+=g.step,
f++){var l="object"!==typeof b?b:1==b.length?b[0]:b[f];numeric.sliceeq(a[e],c,l,d+1)}}};numeric.wrap=function wrap(c,b,d,e){"undefined"===typeof e&&(e=0);"undefined"===typeof d&&(d=numeric.dim(c));"undefined"===typeof b&&(b=d.length);0>b&&(b=d.length+b);if(e===b)return[numeric.clone(c)];var f=d[e];var g=Array(f);for(--f;0<=f;--f)g[f]=wrap(c[f],b,d,e+1);return g};numeric._mask=function(a,c,b,d){d=b[d];var e=[];for(b=0;b<d;b++)c[b]&&e.push(a[b]);return e};
numeric.mask=function mask(c,b,d,e){"undefined"===typeof e&&(e=0);"undefined"===typeof d&&(d=numeric.dim(b));if(e===d.length-1)return numeric._mask(c,b,d,e);var f,g=d[e],l=[];for(f=0;f<g;f++)l=l.concat(mask(c[f],b[f],d,e+1));return l};numeric._maskeq=function(a,c,b,d,e,f){e=d[e];if(1===b.length)for(d=0;d<e;d++)c[d]&&(a[d]=b[0],f++);else for(d=0;d<e;d++)c[d]&&(a[d]=b[f],f++);return f};
numeric.maskeq=function maskeq(c,b,d,e,f,g){"undefined"===typeof f&&(f=0);"undefined"===typeof g&&(g=0);"undefined"===typeof e&&(e=numeric.dim(c));"object"!==typeof d&&(d=[d]);if(f===e.length-1)return numeric._maskeq(c,b,d,e,f,g);var l,h=e[f];for(l=0;l<h;l++)g=maskeq(c[l],b[l],d,e,f+1,g);return g};numeric._index=function(a,c,b,d){d=b[d];b=Array(d);for(--d;0<=d;--d)b[d]=numeric.clone(a[c[d]]);return b};
numeric.index=function(a,c,b,d){if("object"!==typeof c)return a[c];"undefined"===typeof d&&(d=0);"undefined"===typeof b&&(b=numeric.dim(c));if(d===b.length-1)return numeric._index(a,c,b,d);var e=b[d];var f=Array(e);for(--e;0<=e;--e)f[e]=numeric.index(a,c[e],b,d+1);return f};numeric._indexeq=function(a,c,b,d,e,f){d=d[f];f=e[f];if(0===d)for(e=f-1;0<=e;--e)a[c[0]]=numeric.clone(b[e]);if(0===f)for(e=d-1;0<=e;--e)a[c[e]]=numeric.clone(b[0]);else for(e=d-1;0<=e;--e)a[c[e]]=numeric.clone(b[e])};
numeric.indexeq=function(a,c,b,d,e,f){"undefined"===typeof f&&(f=0);"undefined"===typeof d&&(d=numeric.dim(c));"undefined"===typeof e&&(e=numeric.dim(b));f===d.length-1&&numeric._indexeq(a,c,b,d,e,f);var g,l=d[f],h=e[f];if(0===l)for(g=h-1;0<=g;--g)numeric.indexeq(a,c[0],b[g],d,e,f+1);if(0===h)for(g=l-1;0<=g;--g)numeric.indexeq(a,c[g],b[0],d,e,f+1);else for(g=l-1;0<=g;--g)numeric.indexeq(a,c[g],b[g],d,e,f+1)};
numeric.trunc=numeric.pointwise("z[k] = round(x[i]/y[j])*y[j];","var round = Math.round;","binary");
numeric.inv=function(a){var c=numeric.dim(a),b=Math.abs,d=c[0],c=c[1],e=numeric.clone(a),f=numeric.identity(d),g,l;for(l=0;l<c;++l){var h=a=-1;for(g=l;g!==d;++g){var k=b(e[g][l]);k>h&&(a=g,h=k)}h=e[a];e[a]=e[l];e[l]=h;var n=f[a];f[a]=f[l];f[l]=n;a=h[l];for(k=l;k!==c;++k)h[k]/=a;for(k=c-1;-1!==k;--k)n[k]/=a;for(g=d-1;-1!==g;--g)if(g!==l){var p=e[g];var q=f[g];a=p[l];for(k=l+1;k!==c;++k)p[k]-=h[k]*a;for(k=c-1;0<k;--k)q[k]-=n[k]*a,--k,q[k]-=n[k]*a;0===k&&(q[0]-=n[0]*a)}}return f};
numeric.det=function(a){var c=numeric.dim(a);if(2!==c.length||c[0]!==c[1])throw Error("numeric: det() only works on square matrices");var c=c[0],b=1,d,e=numeric.clone(a);for(a=0;a<c-1;a++){var f=a;for(d=a+1;d<c;d++)Math.abs(e[d][a])>Math.abs(e[f][a])&&(f=d);f!==a&&(d=e[f],e[f]=e[a],e[a]=d,b*=-1);var g=e[a];for(d=a+1;d<c;d++){var l=e[d];var h=l[a]/g[a];for(f=a+1;f<c-1;f+=2){var k=f+1;l[f]-=g[f]*h;l[k]-=g[k]*h}f!==c&&(l[f]-=g[f]*h)}if(0===g[a])return 0;b*=g[a]}return b*e[a][a]};
numeric.transpose=function(a){var c;var b=a.length;var d=a[0].length,e=Array(d);for(c=0;c<d;c++)e[c]=Array(b);for(--b;1<=b;b-=2){var f=a[b];var g=a[b-1];for(c=d-1;1<=c;--c){var l=e[c];l[b]=f[c];l[b-1]=g[c];--c;l=e[c];l[b]=f[c];l[b-1]=g[c]}0===c&&(l=e[0],l[b]=f[0],l[b-1]=g[0])}if(0===b){g=a[0];for(c=d-1;1<=c;--c)e[c][0]=g[c],--c,e[c][0]=g[c];0===c&&(e[0][0]=g[0])}return e};
numeric.negtranspose=function(a){var c;var b=a.length;var d=a[0].length,e=Array(d);for(c=0;c<d;c++)e[c]=Array(b);for(--b;1<=b;b-=2){var f=a[b];var g=a[b-1];for(c=d-1;1<=c;--c){var l=e[c];l[b]=-f[c];l[b-1]=-g[c];--c;l=e[c];l[b]=-f[c];l[b-1]=-g[c]}0===c&&(l=e[0],l[b]=-f[0],l[b-1]=-g[0])}if(0===b){g=a[0];for(c=d-1;1<=c;--c)e[c][0]=-g[c],--c,e[c][0]=-g[c];0===c&&(e[0][0]=-g[0])}return e};
numeric._random=function _random(c,b){var d=c[b];var e=Array(d);if(b===c.length-1){var f=Math.random;for(--d;1<=d;d-=2)e[d]=f(),e[d-1]=f();0===d&&(e[0]=f());return e}for(--d;0<=d;d--)e[d]=_random(c,b+1);return e};numeric.random=function(a){return numeric._random(a,0)};numeric.norm2=function(a,c){return numeric.sqrt(numeric.norm2Squared(a,c))};
numeric.linspace=function(a,c,b){"undefined"===typeof b&&(b=Math.max(Math.round(c-a)+1,1));if(2>b)return 1===b?[a]:[];var d,e=Array(b);b--;for(d=b;0<=d;d--)e[d]=(d*c+(b-d)*a)/b;return e};numeric.logspace=function(a,c,b,d){"undefined"===typeof d&&(d=10);return numeric.pow(d,numeric.linspace(a,c,b))};numeric.range=function(a,c,b){"undefined"===typeof b&&(b=1);"undefined"===typeof c&&(c=a,a=0);if(0<b&&c<a||0>b&&c>a)return[];for(var d=[];a<c;a+=b)d.push(a);return d};
numeric.getBlock=function(a,c,b){function d(a,g){var f=c[g];var h=b[g]-f;var k=Array(h);if(g===e.length-1){for(;0<=h;h--)k[h]=a[h+f];return k}for(;0<=h;h--)k[h]=d(a[h+f],g+1);return k}var e=numeric.dim(a);return d(a,0)};numeric.setBlock=function(a,c,b,d){function e(a,d,h){var g,l=c[h],p=b[h]-l;if(h===f.length-1)for(g=p;0<=g;g--)a[g+l]=d[g];for(g=p;0<=g;g--)e(a[g+l],d[g],h+1)}var f=numeric.dim(a);e(a,d,0);return a};
numeric.getRange=function(a,c,b){for(var d=c.length,e=b.length,f,g=Array(d),l,h,d=d-1;-1!==d;--d)for(g[d]=Array(e),l=g[d],h=a[c[d]],f=e-1;-1!==f;--f)l[f]=h[b[f]];return g};
numeric.blockMatrix=function(a){var c=numeric.dim(a);if(4>c.length)return numeric.blockMatrix([a]);var b=c[0],c=c[1],d,e,f,g;for(f=e=d=0;f<b;++f)d+=a[f][0].length;for(g=0;g<c;++g)e+=a[0][g][0].length;var l=Array(d);for(f=0;f<d;++f)l[f]=Array(e);var h=0,k,n;for(f=0;f<b;++f){var p=e;for(g=c-1;-1!==g;--g)for(d=a[f][g],p-=d[0].length,k=d.length-1;-1!==k;--k){var q=d[k];var r=l[h+k];for(n=q.length-1;-1!==n;--n)r[p+n]=q[n]}h+=a[f][0].length}return l};
numeric.tensor=function(a,c){if("number"===typeof a||"number"===typeof c)return numeric.mul(a,c);var b=numeric.dim(a),d=numeric.dim(c);if(1!==b.length||1!==d.length)throw Error("numeric: tensor product is only defined for vectors");var e=b[0],d=d[0],b=Array(e),f,g;for(f=e-1;0<=f;f--){e=Array(d);var l=a[f];for(g=d-1;3<=g;--g)e[g]=l*c[g],--g,e[g]=l*c[g],--g,e[g]=l*c[g],--g,e[g]=l*c[g];for(;0<=g;)e[g]=l*c[g],--g;b[f]=e}return b};numeric.T=function(a,c){this.x=a;this.y=c};
numeric.t=function(a,c){return new numeric.T(a,c)};
numeric.Tbinop=function(a,c,b,d,e){if("string"!==typeof e){var f;e="";for(f in numeric)numeric.hasOwnProperty(f)&&(0<=a.indexOf(f)||0<=c.indexOf(f)||0<=b.indexOf(f)||0<=d.indexOf(f))&&1<f.length&&(e+="var "+f+" = numeric."+f+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+e+"\nif(x.y) {  if(y.y) {    return new numeric.T("+d+");\n  }\n  return new numeric.T("+b+");\n}\nif(y.y) {\n  return new numeric.T("+c+");\n}\nreturn new numeric.T("+a+");\n")};
numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)");numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)");numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))");
numeric.T.prototype.reciprocal=function(){var a=numeric.mul,c=numeric.div;return this.y?(a=numeric.add(a(this.x,this.x),a(this.y,this.y)),new numeric.T(c(this.x,a),c(numeric.neg(this.y),a))):new numeric.T(c(1,this.x),0)};numeric.T.prototype.div=function(a){a instanceof numeric.T||(a=new numeric.T(a));if(a.y)return this.mul(a.reciprocal());var c=numeric.div;return this.y?new numeric.T(c(this.x,a.x),c(this.y,a.x)):new numeric.T(c(this.x,a.x))};
numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))");numeric.T.prototype.transpose=function(){var a=numeric.transpose,c=this.x,b=this.y;return b?new numeric.T(a(c),a(b)):new numeric.T(a(c))};numeric.T.prototype.transjugate=function(){var a=numeric.transpose,c=this.x,b=this.y;return b?new numeric.T(a(c),numeric.negtranspose(b)):new numeric.T(a(c))};
numeric.Tunop=function(a,c,b){"string"!==typeof b&&(b="");return Function("var x = this;\n"+b+"\nif(x.y) {  "+c+";\n}\n"+a+";\n")};numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;");numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));");
numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;");numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));");numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);");
numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;");numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);");numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));");
numeric.T.prototype.inv=function(){if("undefined"===typeof this.y)return new numeric.T(numeric.inv(this.x));var a=this.x.length,c,b,d=numeric.identity(a),e=numeric.rep([a,a],0),f=numeric.clone(this.x),g=numeric.clone(this.y);for(c=0;c<a;c++){var l=f[c][c];var h=g[c][c];var k=l*l+h*h;var n=c;for(b=c+1;b<a;b++){l=f[b][c];h=g[b][c];var p=l*l+h*h;p>k&&(n=b,k=p)}n!==c&&(b=f[c],f[c]=f[n],f[n]=b,b=g[c],g[c]=g[n],g[n]=b,b=d[c],d[c]=d[n],d[n]=b,b=e[c],e[c]=e[n],e[n]=b);p=f[c];var q=g[c];var r=d[c];var t=e[c];
l=p[c];h=q[c];for(b=c+1;b<a;b++){var u=p[b];var A=q[b];p[b]=(u*l+A*h)/k;q[b]=(A*l-u*h)/k}for(b=0;b<a;b++)u=r[b],A=t[b],r[b]=(u*l+A*h)/k,t[b]=(A*l-u*h)/k;for(b=c+1;b<a;b++){k=f[b];var C=g[b];var B=d[b];var w=e[b];l=k[c];h=C[c];for(n=c+1;n<a;n++)u=p[n],A=q[n],k[n]-=u*l-A*h,C[n]-=A*l+u*h;for(n=0;n<a;n++)u=r[n],A=t[n],B[n]-=u*l-A*h,w[n]-=A*l+u*h}}for(c=a-1;0<c;c--)for(r=d[c],t=e[c],b=c-1;0<=b;b--)for(B=d[b],w=e[b],l=f[b][c],h=g[b][c],n=a-1;0<=n;n--)u=r[n],A=t[n],B[n]-=l*u-h*A,w[n]-=l*A+h*u;return new numeric.T(d,
e)};numeric.T.prototype.get=function(a){var c=this.x,b=this.y,d=0,e=a.length;if(b){for(;d<e;){var f=a[d];c=c[f];b=b[f];d++}return new numeric.T(c,b)}for(;d<e;)f=a[d],c=c[f],d++;return new numeric.T(c)};
numeric.T.prototype.set=function(a,c){var b=this.x,d=this.y,e=0,f=a.length,g=c.x,l=c.y;if(0===f)return l?this.y=l:d&&(this.y=void 0),this.x=b,this;if(l){d||(this.y=d=numeric.rep(numeric.dim(b),0));for(;e<f-1;){var h=a[e];b=b[h];d=d[h];e++}h=a[e];b[h]=g;d[h]=l;return this}if(d){for(;e<f-1;)h=a[e],b=b[h],d=d[h],e++;h=a[e];b[h]=g;d[h]=g instanceof Array?numeric.rep(numeric.dim(g),0):0;return this}for(;e<f-1;)h=a[e],b=b[h],e++;h=a[e];b[h]=g;return this};
numeric.T.prototype.getRows=function(a,c){var b=c-a+1,d,e=Array(b),f=this.x,g=this.y;for(d=a;d<=c;d++)e[d-a]=f[d];if(g){b=Array(b);for(d=a;d<=c;d++)b[d-a]=g[d];return new numeric.T(e,b)}return new numeric.T(e)};numeric.T.prototype.setRows=function(a,c,b){var d=this.x,e=this.y,f=b.x,g=b.y;for(b=a;b<=c;b++)d[b]=f[b-a];if(g)for(e||(this.y=e=numeric.rep(numeric.dim(d),0)),b=a;b<=c;b++)e[b]=g[b-a];else if(e)for(b=a;b<=c;b++)e[b]=numeric.rep([f[b-a].length],0);return this};
numeric.T.prototype.getRow=function(a){var c=this.x,b=this.y;return b?new numeric.T(c[a],b[a]):new numeric.T(c[a])};numeric.T.prototype.setRow=function(a,c){var b=this.x,d=this.y,e=c.x,f=c.y;b[a]=e;f?(d||(this.y=d=numeric.rep(numeric.dim(b),0)),d[a]=f):d&&numeric.rep([e.length],0);return this};numeric.T.prototype.getBlock=function(a,c){var b=this.x,d=this.y,e=numeric.getBlock;return d?new numeric.T(e(b,a,c),e(d,a,c)):new numeric.T(e(b,a,c))};
numeric.T.prototype.setBlock=function(a,c,b){b instanceof numeric.T||(b=new numeric.T(b));var d=this.x,e=this.y,f=numeric.setBlock,g=b.x;if(b=b.y)return e||(e=this.y=numeric.rep(numeric.dim(this),0)),f(d,a,c,g),f(e,a,c,b),this;f(d,a,c,g);e&&f(e,a,c,numeric.rep(numeric.dim(g),0))};numeric.T.rep=function(a,c){var b=numeric.T;c instanceof b||(c=new b(c));var d=c.x,e=c.y,f=numeric.rep;return e?new b(f(a,d),f(a,e)):new b(f(a,d))};
numeric.T.diag=function(a){a instanceof numeric.T||(a=new numeric.T(a));var c=a.x;a=a.y;var b=numeric.diag;return a?new numeric.T(b(c),b(a)):new numeric.T(b(c))};numeric.T.eig=function(){if(this.y)throw Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)};numeric.T.identity=function(a){return new numeric.T(numeric.identity(a))};numeric.T.prototype.getDiag=function(){var a=numeric,c=this.x,b=this.y;return b?new a.T(a.getDiag(c),a.getDiag(b)):new a.T(a.getDiag(c))};
numeric.house=function(a){var c=numeric.clone(a);a=(0<=a[0]?1:-1)*numeric.norm2(a);c[0]+=a;a=numeric.norm2(c);if(0===a)throw Error("eig: internal error");return numeric.div(c,a)};
numeric.toUpperHessenberg=function(a){var c=numeric.dim(a);if(2!==c.length||c[0]!==c[1])throw Error("numeric: toUpperHessenberg() only works on square matrices");var c=c[0],b,d=numeric.clone(a),e=numeric.identity(c);for(b=0;b<c-2;b++){var f=Array(c-b-1);for(a=b+1;a<c;a++)f[a-b-1]=d[a][b];if(0<numeric.norm2(f)){var g=numeric.house(f);f=numeric.getBlock(d,[b+1,b],[c-1,c-1]);var l=numeric.tensor(g,numeric.dot(g,f));for(a=b+1;a<c;a++){var h=d[a];var k=l[a-b-1];for(f=b;f<c;f++)h[f]-=2*k[f-b]}f=numeric.getBlock(d,
[0,b+1],[c-1,c-1]);l=numeric.tensor(numeric.dot(f,g),g);for(a=0;a<c;a++)for(h=d[a],k=l[a],f=b+1;f<c;f++)h[f]-=2*k[f-b-1];f=Array(c-b-1);for(a=b+1;a<c;a++)f[a-b-1]=e[a];l=numeric.tensor(g,numeric.dot(g,f));for(a=b+1;a<c;a++)for(g=e[a],k=l[a-b-1],f=0;f<c;f++)g[f]-=2*k[f]}}return{H:d,Q:e}};numeric.epsilon=2.220446049250313E-16;numeric.pi=3.141592653589793;numeric.e=2.718281828459045;
numeric.QRFrancis=function(a,c){var b;"undefined"===typeof c&&(c=1E4);a=numeric.clone(a);numeric.clone(a);var d=numeric.dim(a)[0],e,f,g=numeric.identity(d);if(3>d)return{Q:g,B:[[0,d-1]]};var l=numeric.epsilon;for(b=0;b<c;b++){for(e=0;e<d-1;e++)if(Math.abs(a[e+1][e])<l*(Math.abs(a[e][e])+Math.abs(a[e+1][e+1]))){l=numeric.QRFrancis(numeric.getBlock(a,[0,0],[e,e]),c);b=numeric.QRFrancis(numeric.getBlock(a,[e+1,e+1],[d-1,d-1]),c);var h=Array(e+1);for(f=0;f<=e;f++)h[f]=g[f];h=numeric.dot(l.Q,h);for(f=
0;f<=e;f++)g[f]=h[f];h=Array(d-e-1);for(f=e+1;f<d;f++)h[f-e-1]=g[f];h=numeric.dot(b.Q,h);for(f=e+1;f<d;f++)g[f]=h[f-e-1];return{Q:g,B:l.B.concat(numeric.add(b.B,e+1))}}e=a[d-2][d-2];var k=a[d-2][d-1];h=a[d-1][d-2];var n=a[d-1][d-1];f=e+n;h=e*n-k*h;e=numeric.getBlock(a,[0,0],[2,2]);f*f>=4*h?(k=.5*(f+Math.sqrt(f*f-4*h)),f=.5*(f-Math.sqrt(f*f-4*h)),e=numeric.add(numeric.sub(numeric.dot(e,e),numeric.mul(e,k+f)),numeric.diag(numeric.rep([3],k*f)))):e=numeric.add(numeric.sub(numeric.dot(e,e),numeric.mul(e,
f)),numeric.diag(numeric.rep([3],h)));k=[e[0][0],e[1][0],e[2][0]];var p=numeric.house(k);h=[a[0],a[1],a[2]];h=numeric.tensor(p,numeric.dot(p,h));for(f=0;3>f;f++){var q=a[f];var r=h[f];for(k=0;k<d;k++)q[k]-=2*r[k]}h=numeric.getBlock(a,[0,0],[d-1,2]);h=numeric.tensor(numeric.dot(h,p),p);for(f=0;f<d;f++)for(q=a[f],r=h[f],k=0;3>k;k++)q[k]-=2*r[k];h=[g[0],g[1],g[2]];h=numeric.tensor(p,numeric.dot(p,h));for(f=0;3>f;f++)for(p=g[f],r=h[f],k=0;k<d;k++)p[k]-=2*r[k];for(e=0;e<d-2;e++){for(k=e;k<=e+1;k++)if(Math.abs(a[k+
1][k])<l*(Math.abs(a[k][k])+Math.abs(a[k+1][k+1]))){l=numeric.QRFrancis(numeric.getBlock(a,[0,0],[k,k]),c);b=numeric.QRFrancis(numeric.getBlock(a,[k+1,k+1],[d-1,d-1]),c);h=Array(k+1);for(f=0;f<=k;f++)h[f]=g[f];h=numeric.dot(l.Q,h);for(f=0;f<=k;f++)g[f]=h[f];h=Array(d-k-1);for(f=k+1;f<d;f++)h[f-k-1]=g[f];h=numeric.dot(b.Q,h);for(f=k+1;f<d;f++)g[f]=h[f-k-1];return{Q:g,B:l.B.concat(numeric.add(b.B,k+1))}}n=Math.min(d-1,e+3);k=Array(n-e);for(f=e+1;f<=n;f++)k[f-e-1]=a[f][e];p=numeric.house(k);h=numeric.getBlock(a,
[e+1,e],[n,d-1]);h=numeric.tensor(p,numeric.dot(p,h));for(f=e+1;f<=n;f++)for(q=a[f],r=h[f-e-1],k=e;k<d;k++)q[k]-=2*r[k-e];h=numeric.getBlock(a,[0,e+1],[d-1,n]);h=numeric.tensor(numeric.dot(h,p),p);for(f=0;f<d;f++)for(q=a[f],r=h[f],k=e+1;k<=n;k++)q[k]-=2*r[k-e-1];h=Array(n-e);for(f=e+1;f<=n;f++)h[f-e-1]=g[f];h=numeric.tensor(p,numeric.dot(p,h));for(f=e+1;f<=n;f++)for(p=g[f],r=h[f-e-1],k=0;k<d;k++)p[k]-=2*r[k]}}throw Error("numeric: eigenvalue iteration does not converge -- increase maxiter?");};
numeric.eig=function(a,c){for(var b=numeric.toUpperHessenberg(a),d=numeric.QRFrancis(b.H,c),e=numeric.T,f,g=d.B,l=numeric.dot(d.Q,numeric.dot(b.H,numeric.transpose(d.Q))),d=new e(numeric.dot(d.Q,b.Q)),h,k=g.length,n,p,q,r,t,u,A,C,B=Math.sqrt,b=0;b<k;b++)if(f=g[b][0],f!==g[b][1]&&(n=f+1,p=l[f][f],q=l[f][n],r=l[n][f],t=l[n][n],0!==q||0!==r))h=-p-t,u=p*t-q*r,u=h*h-4*u,0<=u?(h=0>h?-.5*(h-B(u)):-.5*(h+B(u)),A=(p-h)*(p-h)+q*q,C=r*r+(t-h)*(t-h),A>C?(A=B(A),p=(p-h)/A,q/=A):(C=B(C),p=r/C,q=(t-h)/C),h=new e([[q,
-p],[p,q]])):(h*=-.5,u=.5*B(-u),A=(p-h)*(p-h)+q*q,C=r*r+(t-h)*(t-h),A>C?(A=B(A+u*u),p=(p-h)/A,q/=A,h=0,u/=A):(C=B(C+u*u),p=r/C,q=(t-h)/C,h=u/C,u=0),h=new e([[q,-p],[p,q]],[[h,u],[u,-h]])),d.setRows(f,n,h.dot(d.getRows(f,n)));g=d.dot(a).dot(d.transjugate());e=a.length;l=numeric.T.identity(e);for(n=0;n<e;n++)if(0<n)for(b=n-1;0<=b;b--)f=g.get([b,b]),k=g.get([n,n]),numeric.neq(f.x,k.x)||numeric.neq(f.y,k.y)?(h=g.getRow(b).getBlock([b],[n-1]),u=l.getRow(n).getBlock([b],[n-1]),l.set([n,b],g.get([b,n]).neg().sub(h.dot(u)).div(f.sub(k)))):
l.setRow(n,l.getRow(b));for(n=0;n<e;n++)h=l.getRow(n),l.setRow(n,h.div(h.norm2()));l=l.transpose();l=d.transjugate().dot(l);return{lambda:g.getDiag(),E:l}};
numeric.ccsSparse=function(a){var c=a.length,b,d,e=[];for(b=c-1;-1!==b;--b){var f=a[b];for(d in f){for(d=parseInt(d);d>=e.length;)e[e.length]=0;0!==f[d]&&e[d]++}}f=e.length;var g=Array(f+1);for(b=g[0]=0;b<f;++b)g[b+1]=g[b]+e[b];var l=Array(g[f]),h=Array(g[f]);for(b=c-1;-1!==b;--b)for(d in f=a[b],f)0!==f[d]&&(e[d]--,l[g[d]+e[d]]=b,h[g[d]+e[d]]=f[d]);return[g,l,h]};
numeric.ccsFull=function(a){var c=a[0],b=a[1],d=a[2],e=numeric.ccsDim(a);a=e[1];for(var f,g,l=numeric.rep([e[0],a],0),e=0;e<a;e++)for(f=c[e],g=c[e+1];f<g;++f)l[b[f]][e]=d[f];return l};
numeric.ccsTSolve=function(a,c,b,d,e){function f(a){var c;if(0===b[a]){b[a]=1;for(c=g[a];c<g[a+1];++c)f(l[c]);e[n]=a;++n}}var g=a[0],l=a[1];a=a[2];var h=g.length-1,k=Math.max,n=0;"undefined"===typeof d&&(b=numeric.rep([h],0));"undefined"===typeof d&&(d=numeric.linspace(0,b.length-1));"undefined"===typeof e&&(e=[]);for(var p,q,r,h=d.length-1;-1!==h;--h)f(d[h]);e.length=n;for(h=e.length-1;-1!==h;--h)b[e[h]]=0;for(h=d.length-1;-1!==h;--h)p=d[h],b[p]=c[p];for(h=e.length-1;-1!==h;--h){p=e[h];q=g[p];c=
k(g[p+1],q);for(d=q;d!==c;++d)if(l[d]===p){b[p]/=a[d];break}r=b[p];for(d=q;d!==c;++d)q=l[d],q!==p&&(b[q]-=r*a[d])}return b};numeric.ccsDFS=function(a){this.k=Array(a);this.k1=Array(a);this.j=Array(a)};numeric.ccsDFS.prototype.dfs=function(a,c,b,d,e,f){var g=0,l=e.length,h=this.k,k=this.k1,n=this.j,p,q;if(0===d[a])for(d[a]=1,n[0]=a,h[0]=p=c[a],k[0]=q=c[a+1];;)if(p>=q){e[l]=n[g];if(0===g)break;++l;--g;p=h[g];q=k[g]}else a=f[b[p]],0===d[a]?(d[a]=1,h[g]=p,++g,n[g]=a,p=c[a],k[g]=q=c[a+1]):++p};
numeric.ccsLPSolve=function(a,c,b,d,e,f,g){var l=a[0],h=a[1];a=a[2];var k=c[0],n=c[1];c=c[2];var p=k[e];k=k[e+1];d.length=0;for(e=p;e<k;++e)g.dfs(f[n[e]],l,h,b,d,f);for(e=d.length-1;-1!==e;--e)b[d[e]]=0;for(e=p;e!==k;++e)g=f[n[e]],b[g]=c[e];for(e=d.length-1;-1!==e;--e){g=d[e];k=l[g];n=l[g+1];for(c=k;c<n;++c)if(f[h[c]]===g){b[g]/=a[c];break}p=b[g];for(c=k;c<n;++c)k=f[h[c]],k!==g&&(b[k]-=p*a[c])}return b};
numeric.ccsLUP1=function(a,c){var b=a[0].length-1,d=[numeric.rep([b+1],0),[],[]],e=[numeric.rep([b+1],0),[],[]],f=d[0],g=d[1],l=d[2],h=e[0],k=e[1],n=e[2],p=numeric.rep([b],0),q=numeric.rep([b],0),r,t,u,A=numeric.ccsLPSolve,C=Math.abs,B=numeric.linspace(0,b-1),w=numeric.linspace(0,b-1),z=new numeric.ccsDFS(b);"undefined"===typeof c&&(c=1);for(r=0;r<b;++r){A(d,a,p,q,r,w,z);var v=u=-1;for(t=q.length-1;-1!==t;--t){var D=q[t];if(!(D<=r)){var F=C(p[D]);F>u&&(v=D,u=F)}}C(p[r])<c*u&&(t=B[r],u=B[v],B[r]=u,
w[u]=r,B[v]=t,w[t]=v,u=p[r],p[r]=p[v],p[v]=u);u=f[r];v=h[r];var P=p[r];g[u]=B[r];l[u]=1;++u;for(t=q.length-1;-1!==t;--t)D=q[t],F=p[D],q[t]=0,p[D]=0,D<=r?(k[v]=D,n[v]=F,++v):(g[u]=B[D],l[u]=F/P,++u);f[r+1]=u;h[r+1]=v}for(t=g.length-1;-1!==t;--t)g[t]=w[g[t]];return{L:d,U:e,P:B,Pinv:w}};numeric.ccsDFS0=function(a){this.k=Array(a);this.k1=Array(a);this.j=Array(a)};
numeric.ccsDFS0.prototype.dfs=function(a,c,b,d,e,f,g){g=0;var l=e.length,h=this.k,k=this.k1,n=this.j,p,q;if(0===d[a])for(d[a]=1,n[0]=a,h[0]=p=c[f[a]],k[0]=q=c[f[a]+1];;){if(isNaN(p))throw Error("Ow!");if(p>=q){e[l]=f[n[g]];if(0===g)break;++l;--g;p=h[g];q=k[g]}else a=b[p],0===d[a]?(d[a]=1,h[g]=p,++g,n[g]=a,a=f[a],p=c[a],k[g]=q=c[a+1]):++p}};
numeric.ccsLPSolve0=function(a,c,b,d,e,f,g,l){var h=a[0],k=a[1];a=a[2];var n=c[0],p=c[1];c=c[2];var q=n[e];n=n[e+1];d.length=0;for(e=q;e<n;++e)l.dfs(p[e],h,k,b,d,f,g);for(e=d.length-1;-1!==e;--e)f=d[e],b[g[f]]=0;for(e=q;e!==n;++e)f=p[e],b[f]=c[e];for(e=d.length-1;-1!==e;--e){f=d[e];p=g[f];l=h[f];f=h[f+1];for(c=l;c<f;++c)if(k[c]===p){b[p]/=a[c];break}q=b[p];for(c=l;c<f;++c)b[k[c]]-=q*a[c];b[p]=q}};
numeric.ccsLUP0=function(a,c){var b=a[0].length-1,d=[numeric.rep([b+1],0),[],[]],e=[numeric.rep([b+1],0),[],[]],f=d[0],g=d[1],l=d[2],h=e[0],k=e[1],n=e[2],p=numeric.rep([b],0),q=numeric.rep([b],0),r,t,u,A=numeric.ccsLPSolve0,C=Math.abs,B=numeric.linspace(0,b-1),w=numeric.linspace(0,b-1),z=new numeric.ccsDFS0(b);"undefined"===typeof c&&(c=1);for(r=0;r<b;++r){A(d,a,p,q,r,w,B,z);var v=u=-1;for(t=q.length-1;-1!==t;--t){var D=q[t];if(!(D<=r)){var F=C(p[B[D]]);F>u&&(v=D,u=F)}}C(p[B[r]])<c*u&&(t=B[r],u=B[v],
B[r]=u,w[u]=r,B[v]=t,w[t]=v);u=f[r];v=h[r];var P=p[B[r]];g[u]=B[r];l[u]=1;++u;for(t=q.length-1;-1!==t;--t)D=q[t],F=p[B[D]],q[t]=0,p[B[D]]=0,D<=r?(k[v]=D,n[v]=F,++v):(g[u]=B[D],l[u]=F/P,++u);f[r+1]=u;h[r+1]=v}for(t=g.length-1;-1!==t;--t)g[t]=w[g[t]];return{L:d,U:e,P:B,Pinv:w}};numeric.ccsLUP=numeric.ccsLUP0;numeric.ccsDim=function(a){return[numeric.sup(a[1])+1,a[0].length-1]};
numeric.ccsGetBlock=function(a,c,b){var d=numeric.ccsDim(a),e=d[0],f=d[1];"undefined"===typeof c?c=numeric.linspace(0,e-1):"number"===typeof c&&(c=[c]);"undefined"===typeof b?b=numeric.linspace(0,f-1):"number"===typeof b&&(b=[b]);var d=c.length,g=b.length,f=numeric.rep([f],0),l=[],h=[],k=[f,l,h],n=a[0],p=a[1];a=a[2];for(var q=numeric.rep([e],0),r=0,t=numeric.rep([e],0),e=0;e<g;++e){var u=b[e];var A=n[u],C=n[u+1];for(u=A;u<C;++u){var B=p[u];t[B]=1;q[B]=a[u]}for(u=0;u<d;++u)B=c[u],t[B]&&(l[r]=u,h[r]=
q[c[u]],++r);for(u=A;u<C;++u)B=p[u],t[B]=0;f[e+1]=r}return k};
numeric.ccsDot=function(a,c){var b=a[0],d=a[1],e=a[2],f=c[0],g=c[1],l=c[2],h=numeric.ccsDim(a),k=numeric.ccsDim(c),n=h[0],k=k[1],h=numeric.rep([n],0),p=numeric.rep([n],0),n=Array(n),q=numeric.rep([k],0),r=[],t=[],u=[q,r,t],A,C;for(C=0;C!==k;++C){var B=f[C];var w=f[C+1];var z=0;for(A=B;A<w;++A){B=g[A];var v=l[A];var D=b[B];for(B=b[B+1];D<B;++D){var F=d[D];0===p[F]&&(n[z]=F,p[F]=1,z+=1);h[F]+=e[D]*v}}B=q[C];w=B+z;q[C+1]=w;for(A=z-1;-1!==A;--A)v=B+A,D=n[A],r[v]=D,t[v]=h[D],p[D]=0,h[D]=0;q[C+1]=q[C]+
z}return u};
numeric.ccsLUPSolve=function(a,c){var b=a.L,d=a.U,e=c[0],f=!1;"object"!==typeof e&&(c=[[0,c.length],numeric.linspace(0,c.length-1),c],e=c[0],f=!0);var g=c[1],l=c[2],h=b[0].length-1,k=e.length-1,n=numeric.rep([h],0),p=Array(h),q=numeric.rep([h],0),h=Array(h),r=numeric.rep([k+1],0),t=[],u=[],A=numeric.ccsTSolve,C,B,w=0;for(C=0;C<k;++C){var z=0;var v=e[C];for(B=e[C+1];v<B;++v){var D=a.Pinv[g[v]];h[z]=D;q[D]=l[v];++z}h.length=z;A(b,q,n,h,p);for(v=h.length-1;-1!==v;--v)q[h[v]]=0;A(d,n,q,p,h);if(f)return q;
for(v=p.length-1;-1!==v;--v)n[p[v]]=0;for(v=h.length-1;-1!==v;--v)D=h[v],t[w]=D,u[w]=q[D],q[D]=0,++w;r[C+1]=w}return[r,t,u]};
numeric.ccsbinop=function(a,c){"undefined"===typeof c&&(c="");return Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+c+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+
a+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")};
(function(){var a;for(a in numeric.ops2){var c=isFinite(eval("1"+numeric.ops2[a]+"0"))?"[Y[0],Y[1],numeric."+a+"(X,Y[2])]":"NaN";var b=isFinite(eval("0"+numeric.ops2[a]+"1"))?"[X[0],X[1],numeric."+a+"(X[2],Y)]":"NaN";var d=isFinite(eval("1"+numeric.ops2[a]+"0"))&&isFinite(eval("0"+numeric.ops2[a]+"1"))?"numeric.ccs"+a+"MM(X,Y)":"NaN";numeric["ccs"+a+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[a]+"yk;");numeric["ccs"+a]=Function("X","Y",'if(typeof X === "number") return '+c+';\nif(typeof Y === "number") return '+
b+";\nreturn "+d+";\n")}})();numeric.ccsScatter=function(a){var c=a[0],b=a[1];a=a[2];var d=numeric.sup(b)+1,e=c.length,f=numeric.rep([d],0),g=Array(e),l=Array(e),h=numeric.rep([d],0),k;for(k=0;k<e;++k)h[b[k]]++;for(k=0;k<d;++k)f[k+1]=f[k]+h[k];var d=f.slice(0);for(k=0;k<e;++k){var n=b[k];h=d[n];g[h]=c[k];l[h]=a[k];d[n]+=1}return[f,g,l]};
numeric.ccsGather=function(a){var c=a[0],b=a[1];a=a[2];var d=c.length-1,e=b.length,f=Array(e),g=Array(e),e=Array(e),l,h,k;for(l=k=0;l<d;++l){var n=c[l];for(h=c[l+1];n!==h;++n)g[k]=l,f[k]=b[n],e[k]=a[n],++k}return[f,g,e]};numeric.sdim=function dim(c,b,d){"undefined"===typeof b&&(b=[]);if("object"!==typeof c)return b;"undefined"===typeof d&&(d=0);d in b||(b[d]=0);c.length>b[d]&&(b[d]=c.length);for(var e in c)c.hasOwnProperty(e)&&dim(c[e],b,d+1);return b};
numeric.sclone=function clone(c,b,d){"undefined"===typeof b&&(b=0);"undefined"===typeof d&&(d=numeric.sdim(c).length);var e,f=Array(c.length);if(b===d-1){for(e in c)c.hasOwnProperty(e)&&(f[e]=c[e]);return f}for(e in c)c.hasOwnProperty(e)&&(f[e]=clone(c[e],b+1,d));return f};numeric.sdiag=function(a){for(var c=a.length,b=Array(c),d,c=c-1;1<=c;c-=2)d=c-1,b[c]=[],b[c][c]=a[c],b[d]=[],b[d][d]=a[d];0===c&&(b[0]=[],b[0][0]=a[c]);return b};
numeric.sidentity=function(a){return numeric.sdiag(numeric.rep([a],1))};numeric.stranspose=function(a){var c=[],b,d;for(b in a)if(a.hasOwnProperty(b)){var e=a[b];for(d in e)e.hasOwnProperty(d)&&("object"!==typeof c[d]&&(c[d]=[]),c[d][b]=e[d])}return c};numeric.sLUP=function(a,c){throw Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.");};
numeric.sdotMM=function(a,c){var b=a.length,d=numeric.stranspose(c),e=d.length,f,g,l,h=Array(b);for(f=b-1;0<=f;f--){var k=[];b=a[f];for(l=e-1;0<=l;l--){var n=0;var p=d[l];for(g in b)b.hasOwnProperty(g)&&g in p&&(n+=b[g]*p[g]);n&&(k[l]=n)}h[f]=k}return h};numeric.sdotMV=function(a,c){var b=a.length,d,e,f=Array(b);for(d=b-1;0<=d;d--){b=a[d];var g=0;for(e in b)b.hasOwnProperty(e)&&c[e]&&(g+=b[e]*c[e]);g&&(f[d]=g)}return f};
numeric.sdotVM=function(a,c){var b,d,e=[];for(b in a)if(a.hasOwnProperty(b)){var f=c[b];var g=a[b];for(d in f)f.hasOwnProperty(d)&&(e[d]||(e[d]=0),e[d]+=g*f[d])}return e};numeric.sdotVV=function(a,c){var b,d=0;for(b in a)a[b]&&c[b]&&(d+=a[b]*c[b]);return d};
numeric.sdot=function(a,c){var b=numeric.sdim(a).length,d=numeric.sdim(c).length;switch(1E3*b+d){case 0:return a*c;case 1001:return numeric.sdotVV(a,c);case 2001:return numeric.sdotMV(a,c);case 1002:return numeric.sdotVM(a,c);case 2002:return numeric.sdotMM(a,c);default:throw Error("numeric.sdot not implemented for tensors of order "+b+" and "+d);}};
numeric.sscatter=function(a){var c,b,d=a.length,e=[];for(c=a[0].length-1;0<=c;--c)if(a[d-1][c]){var f=e;for(b=0;b<d-2;b++){var g=a[b][c];f[g]||(f[g]=[]);f=f[g]}f[a[b][c]]=a[b+1][c]}return e};
numeric.sgather=function gather(c,b,d){"undefined"===typeof b&&(b=[]);"undefined"===typeof d&&(d=[]);var e;var f=d.length;for(e in c)if(c.hasOwnProperty(e)){d[f]=parseInt(e);var g=c[e];if("number"===typeof g){if(g){if(0===b.length)for(e=f+1;0<=e;--e)b[e]=[];for(e=f;0<=e;--e)b[e].push(d[e]);b[f+1].push(g)}}else gather(g,b,d)}d.length>f&&d.pop();return b};
numeric.cLU=function(a){var c=a[0],b=a[1],d=a[2],e=c.length;a=0;var f,g;for(f=0;f<e;f++)c[f]>a&&(a=c[f]);a++;var l=Array(a),h=Array(a),k=numeric.rep([a],Infinity),n=numeric.rep([a],-Infinity),p;for(g=0;g<e;g++){f=c[g];var q=b[g];q<k[f]&&(k[f]=q);q>n[f]&&(n[f]=q)}for(f=0;f<a-1;f++)n[f]>n[f+1]&&(n[f+1]=n[f]);for(f=a-1;1<=f;f--)k[f]<k[f-1]&&(k[f-1]=k[f]);for(f=0;f<a;f++)h[f]=numeric.rep([n[f]-k[f]+1],0),l[f]=numeric.rep([f-k[f]],0);for(g=0;g<e;g++)f=c[g],h[f][b[g]-k[f]]=d[g];for(f=0;f<a-1;f++)for(c=
f-k[f],d=h[f],q=f+1;k[q]<=f&&q<a;q++){b=f-k[q];e=n[f]-f;var r=h[q];if(p=r[b]/d[c]){for(g=1;g<=e;g++)r[g+b]-=p*d[g+c];l[q][f-k[q]]=p}}d=[];r=[];g=[];p=[];var t=[],u=[],A;for(f=A=e=0;f<a;f++){c=k[f];b=n[f];var C=h[f];for(q=f;q<=b;q++)C[q-c]&&(d[e]=f,r[e]=q,g[e]=C[q-c],e++);C=l[f];for(q=c;q<f;q++)C[q-c]&&(p[A]=f,t[A]=q,u[A]=C[q-c],A++);p[A]=f;t[A]=f;u[A]=1;A++}return{U:[d,r,g],L:[p,t,u]}};
numeric.cLUsolve=function(a,c){var b=a.L,d=a.U,e=numeric.clone(c),f=b[1],b=b[2],g=d[1],l=d[2],d=d[0].length,h=e.length,k,n;for(k=n=0;k<h;k++){for(;f[n]<k;)e[k]-=b[n]*e[f[n]],n++;n++}n=d-1;for(k=h-1;0<=k;k--){for(;g[n]>k;)e[k]-=l[n]*e[g[n]],n--;e[k]/=l[n];n--}return e};
numeric.cgrid=function(a,c){"number"===typeof a&&(a=[a,a]);var b=numeric.rep(a,-1),d,e;if("function"!==typeof c)switch(c){case "L":c=function(b,c){return b>=a[0]/2||c<a[1]/2};break;default:c=function(a,b){return!0}}var f=0;for(d=1;d<a[0]-1;d++)for(e=1;e<a[1]-1;e++)c(d,e)&&(b[d][e]=f,f++);return b};
numeric.cdelsq=function(a){var c=[[-1,0],[0,-1],[0,1],[1,0]],b=numeric.dim(a),d=b[0],b=b[1],e,f,g,l=[],h=[],k=[];for(e=1;e<d-1;e++)for(f=1;f<b-1;f++)if(!(0>a[e][f])){for(g=0;4>g;g++){var n=e+c[g][0];var p=f+c[g][1];0>a[n][p]||(l.push(a[e][f]),h.push(a[n][p]),k.push(-1))}l.push(a[e][f]);h.push(a[e][f]);k.push(4)}return[l,h,k]};numeric.cdotMV=function(a,c){var b,d=a[0],e=a[1],f=a[2],g,l=d.length;for(g=b=0;g<l;g++)d[g]>b&&(b=d[g]);b++;b=numeric.rep([b],0);for(g=0;g<l;g++)b[d[g]]+=f[g]*c[e[g]];return b};
numeric.Spline=function(a,c,b,d,e){this.x=a;this.yl=c;this.yr=b;this.kl=d;this.kr=e};numeric.Spline.prototype._at=function(a,c){var b=this.x,d=this.yl,e=this.yr,f=this.kr,g=numeric.add,l=numeric.sub,h=numeric.mul;var k=l(h(this.kl[c],b[c+1]-b[c]),l(e[c+1],d[c]));f=g(h(f[c+1],b[c]-b[c+1]),l(e[c+1],d[c]));b=(a-b[c])/(b[c+1]-b[c]);l=b*(1-b);return g(g(g(h(1-b,d[c]),h(b,e[c+1])),h(k,l*(1-b))),h(f,l*b))};
numeric.Spline.prototype.at=function(a){if("number"===typeof a){var c=this.x;var b=c.length;var d=Math.floor;var e=0;for(--b;1<b-e;){var f=d((e+b)/2);c[f]<=a?e=f:b=f}return this._at(a,e)}b=a.length;c=Array(b);for(e=b-1;-1!==e;--e)c[e]=this.at(a[e]);return c};
numeric.Spline.prototype.diff=function(){for(var a=this.x,c=this.yl,b=this.yr,d=this.kl,e=this.kr,f=c.length,g,l,h=Array(f),k=Array(f),n=numeric.add,p=numeric.mul,q=numeric.div,r=numeric.sub,f=f-1;-1!==f;--f)g=a[f+1]-a[f],l=r(b[f+1],c[f]),h[f]=q(n(p(l,6),p(d[f],-4*g),p(e[f+1],-2*g)),g*g),k[f+1]=q(n(p(l,-6),p(d[f],2*g),p(e[f+1],4*g)),g*g);return new numeric.Spline(a,d,e,h,k)};
numeric.Spline.prototype.roots=function(){var a=this.x,c=this.yl,b=this.yr,d=this.kl,e=this.kr;"number"===typeof c[0]&&(c=[c],b=[b],d=[d],e=[e]);var f=c.length,g=a.length-1,l,h;var k=Array(f);var n=Math.sqrt;for(l=0;l!==f;++l){var p=c[l];var q=b[l];var r=d[l];var t=e[l];var u=[];for(h=0;h!==g;h++){0<h&&0>q[h]*p[h]&&u.push(a[h]);var A=a[h+1]-a[h];var C=p[h];var B=q[h+1];var w=r[h]/A;var z=t[h+1]/A;A=w-z+3*(C-B);var v=A*A+12*z*C;A=z+3*C+2*w-3*B;C=3*(z+w+2*(C-B));if(0>=v)w=A/C,B=w>a[h]&&w<a[h+1]?[a[h],
w,a[h+1]]:[a[h],a[h+1]];else{w=(A-n(v))/C;var D=(A+n(v))/C;B=[a[h]];w>a[h]&&w<a[h+1]&&B.push(w);D>a[h]&&D<a[h+1]&&B.push(D);B.push(a[h+1])}v=B[0];w=this._at(v,h);for(C=0;C<B.length-1;C++){var F=B[C+1];D=this._at(F,h);if(0===w)u.push(v),v=F,w=D;else if(0===D||0<w*D)v=F,w=D;else{for(var P=0;;){z=(w*F-D*v)/(w-D);if(z<=v||z>=F)break;A=this._at(z,h);if(0<A*D)F=z,D=A,-1===P&&(w*=.5),P=-1;else if(0<A*w)v=z,w=A,1===P&&(D*=.5),P=1;else break}u.push(z);v=B[C+1];w=this._at(v,h)}}0===D&&u.push(F)}k[l]=u}return"number"===
typeof this.yl[0]?k[0]:k};
numeric.spline=function(a,c,b,d){var e=a.length,f=[],g=[],l=[],h,k=numeric.sub,n=numeric.mul,p=numeric.add;for(h=e-2;0<=h;h--)g[h]=a[h+1]-a[h],l[h]=k(c[h+1],c[h]);if("string"===typeof b||"string"===typeof d)b=d="periodic";k=[[],[],[]];switch(typeof b){case "undefined":f[0]=n(3/(g[0]*g[0]),l[0]);k[0].push(0,0);k[1].push(0,1);k[2].push(2/g[0],1/g[0]);break;case "string":f[0]=p(n(3/(g[e-2]*g[e-2]),l[e-2]),n(3/(g[0]*g[0]),l[0]));k[0].push(0,0,0);k[1].push(e-2,0,1);k[2].push(1/g[e-2],2/g[e-2]+2/g[0],1/
g[0]);break;default:f[0]=b,k[0].push(0),k[1].push(0),k[2].push(1)}for(h=1;h<e-1;h++)f[h]=p(n(3/(g[h-1]*g[h-1]),l[h-1]),n(3/(g[h]*g[h]),l[h])),k[0].push(h,h,h),k[1].push(h-1,h,h+1),k[2].push(1/g[h-1],2/g[h-1]+2/g[h],1/g[h]);switch(typeof d){case "undefined":f[e-1]=n(3/(g[e-2]*g[e-2]),l[e-2]);k[0].push(e-1,e-1);k[1].push(e-2,e-1);k[2].push(1/g[e-2],2/g[e-2]);break;case "string":k[1][k[1].length-1]=0;break;default:f[e-1]=d,k[0].push(e-1),k[1].push(e-1),k[2].push(1)}f="number"!==typeof f[0]?numeric.transpose(f):
[f];d=Array(f.length);if("string"===typeof b)for(h=d.length-1;-1!==h;--h)d[h]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(k)),f[h]),d[h][e-1]=d[h][0];else for(h=d.length-1;-1!==h;--h)d[h]=numeric.cLUsolve(numeric.cLU(k),f[h]);d="number"===typeof c[0]?d[0]:numeric.transpose(d);return new numeric.Spline(a,c,c,d,d)};
numeric.fftpow2=function fftpow2(c,b){var d=c.length;if(1!==d){var e=Math.cos,f=Math.sin,g,l=Array(d/2),h=Array(d/2),k=Array(d/2),n=Array(d/2);var p=d/2;for(g=d-1;-1!==g;--g)--p,k[p]=c[g],n[p]=b[g],--g,l[p]=c[g],h[p]=b[g];fftpow2(l,h);fftpow2(k,n);p=d/2;var q=-6.283185307179586/d;for(g=d-1;-1!==g;--g){--p;-1===p&&(p=d/2-1);var r=q*g;var t=e(r);r=f(r);c[g]=l[p]+t*k[p]-r*n[p];b[g]=h[p]+t*n[p]+r*k[p]}}};
numeric._ifftpow2=function _ifftpow2(c,b){var d=c.length;if(1!==d){var e=Math.cos,f=Math.sin,g,l=Array(d/2),h=Array(d/2),k=Array(d/2),n=Array(d/2);var p=d/2;for(g=d-1;-1!==g;--g)--p,k[p]=c[g],n[p]=b[g],--g,l[p]=c[g],h[p]=b[g];_ifftpow2(l,h);_ifftpow2(k,n);p=d/2;var q=6.283185307179586/d;for(g=d-1;-1!==g;--g){--p;-1===p&&(p=d/2-1);var r=q*g;var t=e(r);r=f(r);c[g]=l[p]+t*k[p]-r*n[p];b[g]=h[p]+t*n[p]+r*k[p]}}};
numeric.ifftpow2=function(a,c){numeric._ifftpow2(a,c);numeric.diveq(a,a.length);numeric.diveq(c,c.length)};numeric.convpow2=function(a,c,b,d){numeric.fftpow2(a,c);numeric.fftpow2(b,d);var e;for(e=a.length-1;-1!==e;--e){var f=a[e];var g=c[e];var l=b[e];var h=d[e];a[e]=f*l-g*h;c[e]=f*h+g*l}numeric.ifftpow2(a,c)};
numeric.T.prototype.fft=function(){var a=this.x,c=this.y,b=a.length,d=Math.log,e=d(2),d=Math.ceil(d(2*b-1)/e),f=Math.pow(2,d),d=numeric.rep([f],0),e=numeric.rep([f],0),g=Math.cos,l=Math.sin,h,k=-numeric.pi/b,n=numeric.rep([f],0),p=numeric.rep([f],0);for(h=0;h<b;h++)n[h]=a[h];if("undefined"!==typeof c)for(h=0;h<b;h++)p[h]=c[h];for(h=d[0]=1;h<=f/2;h++)a=k*h*h,d[h]=g(a),e[h]=l(a),d[f-h]=g(a),e[f-h]=l(a);a=new numeric.T(n,p);c=new numeric.T(d,e);a=a.mul(c);numeric.convpow2(a.x,a.y,numeric.clone(c.x),
numeric.neg(c.y));a=a.mul(c);a.x.length=b;a.y.length=b;return a};
numeric.T.prototype.ifft=function(){var a=this.x,c=this.y,b=a.length,d=Math.log,e=d(2),d=Math.ceil(d(2*b-1)/e),f=Math.pow(2,d),d=numeric.rep([f],0),e=numeric.rep([f],0),g=Math.cos,l=Math.sin,h,k=numeric.pi/b,n=numeric.rep([f],0),p=numeric.rep([f],0);for(h=0;h<b;h++)n[h]=a[h];if("undefined"!==typeof c)for(h=0;h<b;h++)p[h]=c[h];for(h=d[0]=1;h<=f/2;h++)a=k*h*h,d[h]=g(a),e[h]=l(a),d[f-h]=g(a),e[f-h]=l(a);a=new numeric.T(n,p);c=new numeric.T(d,e);a=a.mul(c);numeric.convpow2(a.x,a.y,numeric.clone(c.x),
numeric.neg(c.y));a=a.mul(c);a.x.length=b;a.y.length=b;return a.div(b)};
numeric.gradient=function(a,c){var b=c.length,d=a(c);if(isNaN(d))throw Error("gradient: f(x) is a NaN!");var e,f=numeric.clone(c),g=Array(b);var l=Math.max;var h=Math.abs,k=Math.min,n=0;for(e=0;e<b;e++)for(var p=l(1E-6*d,1E-8);;){++n;if(20<n)throw Error("Numerical gradient fails");f[e]=c[e]+p;var q=a(f);f[e]=c[e]-p;var r=a(f);f[e]=c[e];if(isNaN(q)||isNaN(r))p/=16;else{g[e]=(q-r)/(2*p);var t=c[e]-p;var u=c[e];var A=c[e]+p;var C=(q-d)/p;var B=(d-r)/p;q=l(h(g[e]),h(d),h(q),h(r),h(t),h(u),h(A),1E-8);
C=k(l(h(C-g[e]),h(B-g[e]),h(C-B))/q,p/q);if(.001<C)p/=16;else break}}return g};
numeric.uncmin=function(a,c,b,d,e,f,g){var l=numeric.gradient;"undefined"===typeof g&&(g={});"undefined"===typeof b&&(b=1E-8);"undefined"===typeof d&&(d=function(b){return l(a,b)});"undefined"===typeof e&&(e=1E3);c=numeric.clone(c);var h=c.length,k=a(c);if(isNaN(k))throw Error("uncmin: f(x0) is a NaN!");var n=Math.max,p=numeric.norm2;b=n(b,numeric.epsilon);var q;g=g.Hinv||numeric.identity(h);var h=numeric.dot,n=numeric.sub,r=numeric.add,t=numeric.tensor,u=numeric.div,A=numeric.mul,C=numeric.all,B=
numeric.isFinite,w=numeric.neg,z=0,v,D="";for(q=d(c);z<e;){if("function"===typeof f&&f(z,c,k,q,g)){D="Callback returned true";break}if(!C(B(q))){D="Gradient has Infinity or NaN";break}var F=w(h(g,q));if(!C(B(F))){D="Search direction has Infinity or NaN";break}var P=p(F);if(P<b){D="Newton step smaller than tol";break}var Z=1;var ca=h(q,F);for(v=c;z<e&&!(Z*P<b);){var E=A(F,Z);v=r(c,E);var I=a(v);if(I-k>=.1*Z*ca||isNaN(I))Z*=.5,++z;else break}if(Z*P<b){D="Line search step size smaller than tol";break}if(z===
e){D="maxit reached during line search";break}ca=d(v);c=n(ca,q);q=h(c,E);k=h(g,c);g=n(r(g,A((q+h(c,k))/(q*q),t(E,E))),u(r(t(k,E),t(E,k)),q));c=v;k=I;q=ca;++z}return{solution:c,f:k,gradient:q,invHessian:g,iterations:z,message:D}};numeric.Dopri=function(a,c,b,d,e,f,g){this.x=a;this.y=c;this.f=b;this.ymid=d;this.iterations=e;this.events=g;this.message=f};
numeric.Dopri.prototype._at=function(a,c){function b(a){return a*a}var d=this.x,e=this.y,f=this.f,g=this.ymid,l=numeric.add,h=numeric.mul,k=numeric.sub;var n=d[c];var p=d[c+1];d=e[c];e=e[c+1];var q=n+.5*(p-n);g=g[c];var r=k(f[c],h(d,1/(n-q)+2/(n-p)));f=k(f[c+1],h(e,1/(p-q)+2/(p-n)));n=[b(a-p)*(a-q)/b(n-p)/(n-q),b(a-n)*b(a-p)/b(n-q)/b(p-q),b(a-n)*(a-q)/b(p-n)/(p-q),(a-n)*b(a-p)*(a-q)/b(n-p)/(n-q),(a-p)*b(a-n)*(a-q)/b(n-p)/(p-q)];return l(l(l(l(h(d,n[0]),h(g,n[1])),h(e,n[2])),h(r,n[3])),h(f,n[4]))};
numeric.Dopri.prototype.at=function(a){var c=Math.floor;if("number"!==typeof a){var b=a.length;var d=Array(b);for(--b;-1!==b;--b)d[b]=this.at(a[b]);return d}var e=this.x;b=0;for(d=e.length-1;1<d-b;){var f=c(.5*(b+d));e[f]<=a?b=f:d=f}return this._at(a,b)};
numeric.dopri=function(a,c,b,d,e,f,g){"undefined"===typeof e&&(e=1E-6);"undefined"===typeof f&&(f=1E3);var l=[a],h=[b],k=[d(a,b)],n=[],p=[.075,.225],q=[44/45,-56/15,32/9],r=[19372/6561,-25360/2187,64448/6561,-212/729],t=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],u=[35/384,0,500/1113,125/192,-2187/6784,11/84],A=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],C=[.2,.3,.8,8/9,1,1],B=[-71/57600,0,71/16695,-71/1920,17253/339200,
-22/525,.025],w=0,z=(c-a)/10,v=0,D=numeric.add,F=numeric.mul,P=Math.min,Z=Math.abs,ca=numeric.norminf,E=Math.pow,I=numeric.any,R=numeric.lt,T=numeric.and,H,J=new numeric.Dopri(l,h,k,n,-1,"");for("function"===typeof g&&(H=g(a,b));a<c&&v<f;){++v;a+z>c&&(z=c-a);var X=d(a+C[0]*z,D(b,F(.2*z,k[w])));var V=d(a+C[1]*z,D(D(b,F(p[0]*z,k[w])),F(p[1]*z,X)));var U=d(a+C[2]*z,D(D(D(b,F(q[0]*z,k[w])),F(q[1]*z,X)),F(q[2]*z,V)));var O=d(a+C[3]*z,D(D(D(D(b,F(r[0]*z,k[w])),F(r[1]*z,X)),F(r[2]*z,V)),F(r[3]*z,U)));var ba=
d(a+C[4]*z,D(D(D(D(D(b,F(t[0]*z,k[w])),F(t[1]*z,X)),F(t[2]*z,V)),F(t[3]*z,U)),F(t[4]*z,O)));X=D(D(D(D(D(b,F(k[w],z*u[0])),F(V,z*u[2])),F(U,z*u[3])),F(O,z*u[4])),F(ba,z*u[5]));var ea=d(a+z,X);var da=D(D(D(D(D(F(k[w],z*B[0]),F(V,z*B[2])),F(U,z*B[3])),F(O,z*B[4])),F(ba,z*B[5])),F(ea,z*B[6]));da="number"===typeof da?Z(da):ca(da);if(da>e){if(z=.2*z*E(e/da,.25),a+z===a){J.msg="Step size became too small";break}}else{n[w]=D(D(D(D(D(D(b,F(k[w],z*A[0])),F(V,z*A[2])),F(U,z*A[3])),F(O,z*A[4])),F(ba,z*A[5])),
F(ea,z*A[6]));++w;l[w]=a+z;h[w]=X;k[w]=ea;if("function"===typeof g){V=a;U=a+.5*z;var W=g(U,n[w-1]);b=T(R(H,0),R(0,W));I(b)||(V=U,U=a+z,H=W,W=g(U,X),b=T(R(H,0),R(0,W)));if(I(b)){e=0;for(l=f=1;;){if("number"===typeof H)c=(l*W*V-f*H*U)/(l*W-f*H);else for(c=U,h=H.length-1;-1!==h;--h)0>H[h]&&0<W[h]&&(c=P(c,(l*W[h]*V-f*H[h]*U)/(l*W[h]-f*H[h])));if(c<=V||c>=U)break;var aa=J._at(c,w-1);k=g(c,aa);h=T(R(H,0),R(0,k));I(h)?(U=c,W=k,b=h,l=1,f=-1===e?.5*f:1,e=-1):(V=c,H=k,f=1,l=1===e?.5*l:1,e=1)}X=J._at(.5*(a+
c),w-1);J.f[w]=d(c,aa);J.x[w]=c;J.y[w]=aa;J.ymid[w-1]=X;J.events=b;J.iterations=v;return J}}a+=z;b=X;H=W;z=P(.8*z*E(e/da,.25),4*z)}}J.iterations=v;return J};
numeric.LU=function(a,c){var b=Math.abs,d,e,f=a.length,g=f-1,l=Array(f);c||(a=numeric.clone(a));for(e=0;e<f;++e){var h=e;var k=a[e];var n=b(k[e]);for(d=e+1;d<f;++d){var p=b(a[d][e]);n<p&&(n=p,h=d)}l[e]=h;h!=e&&(a[e]=a[h],a[h]=k,k=a[e]);d=k[e];for(p=e+1;p<f;++p)a[p][e]/=d;for(p=e+1;p<f;++p){h=a[p];for(d=e+1;d<g;++d)h[d]-=h[e]*k[d],++d,h[d]-=h[e]*k[d];d===g&&(h[d]-=h[e]*k[d])}}return{LU:a,P:l}};
numeric.LUsolve=function(a,c){var b,d=a.LU,e=d.length,f=numeric.clone(c),g=a.P;for(b=e-1;-1!==b;--b)f[b]=c[b];for(b=0;b<e;++b){var l=g[b];if(g[b]!==b){var h=f[b];f[b]=f[l];f[l]=h}h=d[b];for(l=0;l<b;++l)f[b]-=f[l]*h[l]}for(b=e-1;0<=b;--b){h=d[b];for(l=b+1;l<e;++l)f[b]-=f[l]*h[l];f[b]/=h[b]}return f};numeric.solve=function(a,c,b){return numeric.LUsolve(numeric.LU(a,b),c)};
numeric.echelonize=function(a){var c=numeric.dim(a),b=c[0],c=c[1],d=numeric.identity(b),e=Array(b),f,g,l,h=Math.abs,k=numeric.diveq;a=numeric.clone(a);for(f=0;f<b;++f){var n=0;var p=a[f];var q=d[f];for(g=1;g<c;++g)h(p[n])<h(p[g])&&(n=g);e[f]=n;k(q,p[n]);k(p,p[n]);for(g=0;g<b;++g)if(g!==f){var r=a[g];var t=r[n];for(l=c-1;-1!==l;--l)r[l]-=p[l]*t;r=d[g];for(l=b-1;-1!==l;--l)r[l]-=q[l]*t}}return{I:d,A:a,P:e}};
numeric.__solveLP=function(a,c,b,d,e,f,g){var l=numeric.sum,h=numeric.mul,k=numeric.sub,n=numeric.dot,p=numeric.div,q=numeric.add,r=a.length,t=b.length;numeric.transpose(c);var u=numeric.transpose,A=Math.sqrt,C=Math.abs,B=Math.min,w=numeric.all,z=numeric.gt,v=Array(r),D=Array(t);numeric.rep([t],1);var F=numeric.solve,P=k(b,n(c,f)),Z,ca=n(a,a);for(Z=0;Z<e;++Z){var E;for(E=t-1;-1!==E;--E)D[E]=p(c[E],P[E]);var I=u(D);for(E=r-1;-1!==E;--E)v[E]=l(I[E]);var R=.25*C(ca/n(a,v));E=100*A(ca/n(v,v));if(!isFinite(R)||
R>E)R=E;var T=q(a,h(R,v));I=n(I,D);for(E=r-1;-1!==E;--E)I[E][E]+=1;I=F(I,p(T,R),!0);var P=p(P,n(c,I)),H=1;for(E=t-1;-1!==E;--E)0>P[E]&&(H=B(H,-.999*P[E]));I=k(f,h(I,H));P=k(b,n(c,I));if(!w(z(P,0)))return{solution:f,message:"",iterations:Z};f=I;if(R<d)return{solution:I,message:"",iterations:Z};if(g)for(R=n(a,T),H=n(c,T),T=!0,E=t-1;-1!==E;--E){if(0>R*H[E]){T=!1;break}}else T=0<=f[r-1]?!1:!0;if(T)return{solution:I,message:"Unbounded",iterations:Z}}return{solution:f,message:"maximum iteration count exceeded",
iterations:Z}};
numeric._solveLP=function(a,c,b,d,e){var f=a.length,g=b.length,l=numeric.sub,h=numeric.dot,k=numeric.rep([f],0).concat([1]),g=numeric.rep([g,1],-1),n=numeric.blockMatrix([[c,g]]),g=numeric.rep([f],0).concat(Math.max(0,numeric.sup(numeric.neg(b)))+1),k=numeric.__solveLP(k,n,b,d,e,g,!1),g=numeric.clone(k.solution);g.length=f;if(0>numeric.inf(l(b,h(c,g))))return{solution:NaN,message:"Infeasible",iterations:k.iterations};a=numeric.__solveLP(a,c,b,d,e-k.iterations,g,!0);a.iterations+=k.iterations;return a};
numeric.solveLP=function(a,c,b,d,e,f,g){"undefined"===typeof g&&(g=1E3);"undefined"===typeof f&&(f=numeric.epsilon);if("undefined"===typeof d)return numeric._solveLP(a,c,b,f,g);var l=d.length,h=d[0].length,k=c.length,n=numeric.echelonize(d),p=numeric.rep([h],0),q=n.P,r=[],t;for(t=q.length-1;-1!==t;--t)p[q[t]]=1;for(t=h-1;-1!==t;--t)0===p[t]&&r.push(t);t=numeric.getRange;l=numeric.linspace(0,l-1);k=numeric.linspace(0,k-1);d=t(d,l,r);l=t(c,k,q);t=t(c,k,r);c=numeric.dot;k=numeric.sub;h=c(l,n.I);l=k(t,
c(h,d));b=k(b,c(h,e));h=Array(q.length);p=Array(r.length);for(t=q.length-1;-1!==t;--t)h[t]=a[q[t]];for(t=r.length-1;-1!==t;--t)p[t]=a[r[t]];t=k(p,c(h,c(n.I,d)));f=numeric._solveLP(t,l,b,f,g);g=f.solution;if(g!==g)return f;e=c(n.I,k(e,c(d,g)));a=Array(a.length);for(t=q.length-1;-1!==t;--t)a[q[t]]=e[t];for(t=r.length-1;-1!==t;--t)a[r[t]]=g[t];return{solution:a,message:f.message,iterations:f.iterations}};
numeric.MPStoLP=function(a){function c(c){throw Error("MPStoLP: "+c+"\nLine "+f+": "+a[f]+"\nCurrent state: "+d[b]+"\n");}a instanceof String&&a.split("\n");var b=0,d="Initial state;NAME;ROWS;COLUMNS;RHS;BOUNDS;ENDATA".split(";"),e=a.length,f,g,l=0,h={},k=[],n=0,p={},q=0,r,t=[],u=[],A=[];for(f=0;f<e;++f){var C=a[f];var B=C.match(/\S*/g),w=[];for(g=0;g<B.length;++g)""!==B[g]&&w.push(B[g]);if(0!==w.length){for(g=0;g<d.length&&C.substr(0,d[g].length)!==d[g];++g);if(g<d.length){if(b=g,1===g&&(r=w[1]),
6===g)return{name:r,c:t,A:numeric.transpose(u),b:A,rows:h,vars:p}}else switch(b){case 0:case 1:c("Unexpected line");case 2:switch(w[0]){case "N":0===l?l=w[1]:c("Two or more N rows");break;case "L":h[w[1]]=n;k[n]=1;A[n]=0;++n;break;case "G":h[w[1]]=n;k[n]=-1;A[n]=0;++n;break;case "E":h[w[1]]=n;k[n]=0;A[n]=0;++n;break;default:c("Parse error "+numeric.prettyPrint(w))}break;case 3:p.hasOwnProperty(w[0])||(p[w[0]]=q,t[q]=0,u[q]=numeric.rep([n],0),++q);C=p[w[0]];for(g=1;g<w.length;g+=2)w[g]===l?t[C]=parseFloat(w[g+
1]):(B=h[w[g]],u[C][B]=(0>k[B]?-1:1)*parseFloat(w[g+1]));break;case 4:for(g=1;g<w.length;g+=2)A[h[w[g]]]=(0>k[h[w[g]]]?-1:1)*parseFloat(w[g+1]);break;case 6:c("Internal error")}}}c("Reached end of file without ENDATA")};numeric.seedrandom={pow:Math.pow,random:Math.random};
(function(a,c,b,d,e,f,g){function l(a){var c=this,d=a.length,e=0,f=c.i=c.j=c.m=0;c.S=[];c.c=[];for(d||(a=[d++]);e<b;)c.S[e]=e++;for(e=0;e<b;e++){var g=c.S[e];f=f+g+a[e%d]&b-1;var h=c.S[f];c.S[e]=h;c.S[f]=g}c.g=function(a){var d=c.S,e=c.i+1&b-1,f=d[e],g=c.j+f&b-1,h=d[g];d[e]=h;d[g]=f;for(var l=d[f+h&b-1];--a;)e=e+1&b-1,f=d[e],g=g+f&b-1,h=d[g],d[e]=h,d[g]=f,l=l*b+d[f+h&b-1];c.i=e;c.j=g;return l};c.g(b)}function h(a,b,c,d,e){c=[];e=typeof a;if(b&&"object"==e)for(d in a)if(5>d.indexOf("S"))try{c.push(h(a[d],
b-1))}catch(u){}return c.length?c:a+("string"!=e?"\x00":"")}function k(a,c,d,e){a+="";for(e=d=0;e<a.length;e++)c[e&b-1]=(d^=19*c[e&b-1])+a.charCodeAt(e)&b-1;a="";for(e in c)a+=String.fromCharCode(c[e]);return a}c.seedrandom=function(n,p){var q=[];n=k(h(p?[n,a]:arguments.length?n:[(new Date).getTime(),a,window],3),q);var r=new l(q);k(r.S,a);c.random=function(){for(var a=r.g(d),c=g,h=0;a<e;)a=(a+h)*b,c*=b,h=r.g(1);for(;a>=f;)a/=2,c/=2,h>>>=1;return(a+h)/c};return n};g=c.pow(b,d);e=c.pow(2,e);f=2*e;
k(c.random(),a)})([],numeric.seedrandom,256,6,52);
(function(a){function c(a){if("object"!==typeof a)return a;var b=[],d,e=a.length;for(d=0;d<e;d++)b[d+1]=c(a[d]);return b}function b(a){if("object"!==typeof a)return a;var c=[],d,e=a.length;for(d=1;d<e;d++)c[d-1]=b(a[d]);return c}function d(a,b,c){var d,e;for(b=1;b<=c;b+=1){a[b][b]=1/a[b][b];var f=-a[b][b];for(d=1;d<b;d+=1)a[d][b]*=f;d=b+1;if(c<d)break;for(e=d;e<=c;e+=1)for(f=a[b][e],a[b][e]=0,d=1;d<=b;d+=1)a[d][e]+=f*a[d][b]}}function e(a,b,c,d){var e,f;for(e=1;e<=c;e+=1){var g=0;for(b=1;b<e;b+=1)g+=
a[b][e]*d[b];d[e]=(d[e]-g)/a[e][e]}for(f=1;f<=c;f+=1)for(e=c+1-f,d[e]/=a[e][e],g=-d[e],b=1;b<e;b+=1)d[b]+=g*a[b][e]}function f(a,b,c,d){var e,f;for(e=1;e<=c;e+=1){d[1]=e;var g=0;var h=e-1;if(!(1>h))for(f=1;f<=h;f+=1){var l=a[f][e];for(b=1;b<f;b+=1)l-=a[b][e]*a[b][f];l/=a[f][f];a[f][e]=l;g+=l*l}g=a[e][e]-g;if(0>=g)break;a[e][e]=Math.sqrt(g);d[1]=0}}function g(a,b,c,g,p,q,r,t,u,A,C,B,w,z,v,D){function h(){for(k=1;k<=g;k+=1){K=0;for(n=1;n<=g;n+=1)K+=a[n][k]*r[n][I];v[k]=K}L=W;for(k=1;k<=g;k+=1)v[L+k]=
0;for(n=w+1;n<=g;n+=1)for(k=1;k<=g;k+=1)v[L+k]+=a[k][n]*v[n];V=!0;for(k=w;1<=k;--k){K=v[k];O=ga+k*(k+3)/2;L=O-k;for(n=k+1;n<=w;n+=1)K-=v[O]*v[aa+n],O+=n;K/=v[L];v[aa+k]=K;if(B[k]<C)break;if(0>K)break;V=!1;E=k}if(!V)for(R=v[Y+E]/v[aa+E],k=1;k<=w&&!(B[k]<C)&&!(0>v[aa+k]);k+=1)N=v[Y+k]/v[aa+k],N<R&&(R=N,E=k);K=0;for(k=W+1;k<=W+g;k+=1)K+=v[k]*v[k];if(Math.abs(K)<=ba){if(V)return D[1]=1,999;for(k=1;k<=w;k+=1)v[Y+k]-=R*v[aa+k];v[Y+w+1]+=R;return 700}K=0;for(k=1;k<=g;k+=1)K+=v[W+k]*r[k][I];T=-v[fa+I]/K;
U=!0;!V&&R<T&&(T=R,U=!1);for(k=1;k<=g;k+=1)p[k]+=T*v[W+k],Math.abs(p[k])<ba&&(p[k]=0);q[1]+=T*K*(T/2+v[Y+w+1]);for(k=1;k<=w;k+=1)v[Y+k]-=T*v[aa+k];v[Y+w+1]+=T;if(U){w+=1;B[w]=I;O=ga+(w-1)*w/2+1;for(k=1;k<=w-1;k+=1)v[O]=v[k],O+=1;if(w===g)v[O]=v[g];else{for(k=g;k>=w+1&&0!==v[k];--k){H=Math.max(Math.abs(v[k-1]),Math.abs(v[k]));J=Math.min(Math.abs(v[k-1]),Math.abs(v[k]));N=0<=v[k-1]?Math.abs(H*Math.sqrt(1+J*J/(H*H))):-Math.abs(H*Math.sqrt(1+J*J/(H*H)));H=v[k-1]/N;J=v[k]/N;if(1===H)break;if(0===H)for(v[k-
1]=J*N,n=1;n<=g;n+=1)N=a[n][k-1],a[n][k-1]=a[n][k],a[n][k]=N;else for(v[k-1]=N,X=J/(1+H),n=1;n<=g;n+=1)N=H*a[n][k-1]+J*a[n][k],a[n][k]=X*(a[n][k-1]+N)-a[n][k],a[n][k-1]=N}v[O]=v[w]}}else{K=-t[I];for(n=1;n<=g;n+=1)K+=p[n]*r[n][I];if(I>C)v[fa+I]=K;else if(v[fa+I]=-Math.abs(K),0<K){for(n=1;n<=g;n+=1)r[n][I]=-r[n][I];t[I]=-t[I]}return 700}return 0}function l(){O=ga+E*(E+1)/2+1;L=O+E;if(0===v[L])return 798;H=Math.max(Math.abs(v[L-1]),Math.abs(v[L]));J=Math.min(Math.abs(v[L-1]),Math.abs(v[L]));N=0<=v[L-
1]?Math.abs(H*Math.sqrt(1+J*J/(H*H))):-Math.abs(H*Math.sqrt(1+J*J/(H*H)));H=v[L-1]/N;J=v[L]/N;if(1===H)return 798;if(0===H){for(k=E+1;k<=w;k+=1)N=v[L-1],v[L-1]=v[L],v[L]=N,L+=k;for(k=1;k<=g;k+=1)N=a[k][E],a[k][E]=a[k][E+1],a[k][E+1]=N}else{X=J/(1+H);for(k=E+1;k<=w;k+=1)N=H*v[L-1]+J*v[L],v[L]=X*(v[L-1]+N)-v[L],v[L-1]=N,L+=k;for(k=1;k<=g;k+=1)N=H*a[k][E]+J*a[k][E+1],a[k][E+1]=X*(a[k][E]+N)-a[k][E+1],a[k][E]=N}return 0}var k,n,E,I,R,T,H,J,X,V,U;u=Math.min(g,A);var O=2*g+u*(u+5)/2+2*A+1;var ba=1E-60;
do{ba+=ba;var ea=1+.1*ba;var da=1+.2*ba}while(1>=ea||1>=da);for(k=1;k<=g;k+=1)v[k]=b[k];for(k=g+1;k<=O;k+=1)v[k]=0;for(k=1;k<=A;k+=1)B[k]=0;ea=[];if(0===D[1]){f(a,c,g,ea);if(0!==ea[1]){D[1]=2;return}e(a,c,g,b);d(a,c,g)}else{for(n=1;n<=g;n+=1)for(p[n]=0,k=1;k<=n;k+=1)p[n]+=a[k][n]*b[k];for(n=1;n<=g;n+=1)for(b[n]=0,k=n;k<=g;k+=1)b[n]+=a[n][k]*p[k]}q[1]=0;for(n=1;n<=g;n+=1)for(p[n]=b[n],q[1]+=v[n]*p[n],v[n]=0,k=n+1;k<=g;k+=1)a[k][n]=0;q[1]=-q[1]/2;D[1]=0;var W=g;var aa=W+g;var Y=aa+u;var ga=Y+u+1;var fa=
ga+u*(u+1)/2;b=fa+A;for(k=1;k<=A;k+=1){var K=0;for(n=1;n<=g;n+=1)K+=r[n][k]*r[n][k];v[b+k]=Math.sqrt(K)}w=0;z[1]=0;for(c=z[2]=0;;){z[1]+=1;O=fa;for(k=1;k<=A;k+=1){O+=1;K=-t[k];for(n=1;n<=g;n+=1)K+=r[n][k]*p[n];Math.abs(K)<ba&&(K=0);if(k>C)v[O]=K;else if(v[O]=-Math.abs(K),0<K){for(n=1;n<=g;n+=1)r[n][k]=-r[n][k];t[k]=-t[k]}}for(k=1;k<=w;k+=1)v[fa+B[k]]=0;var N=I=0;for(k=1;k<=A;k+=1)v[fa+k]<N*v[b+k]&&(I=k,N=v[fa+k]/v[b+k]);c=0===I?999:0;if(999===c)break;for(;;){c=h();if(0===c)break;if(999===c)return;
if(700===c){if(E!==w)for(;;){l();var L=O-E;for(k=1;k<=E;k+=1)v[L]=v[O],O+=1,L+=1;v[Y+E]=v[Y+E+1];B[E]=B[E+1];E+=1;c=E<w?797:0;if(797!==c)break}v[Y+w]=v[Y+w+1];v[Y+w+1]=0;B[w]=0;--w;z[2]+=1}}}}a.solveQP=function(a,d,e,f,p,q){a=c(a);d=c(d);e=c(e);var h,k=[],l=[],n=[],C=[],B=[];p=p||0;q=q?c(q):[void 0,0];f=f?c(f):[];var w=a.length-1;var z=e[1].length-1;if(!f)for(h=1;h<=z;h+=1)f[h]=0;for(h=1;h<=z;h+=1)l[h]=0;var v=Math.min(w,z);for(h=1;h<=w;h+=1)n[h]=0;k[1]=0;for(h=1;h<=2*w+v*(v+5)/2+2*z+1;h+=1)C[h]=
0;for(h=1;2>=h;h+=1)B[h]=0;g(a,d,w,w,n,k,e,f,w,z,p,l,0,B,C,q);a="";1===q[1]&&(a="constraints are inconsistent, no solution!");2===q[1]&&(a="matrix D in quadratic function is not positive definite!");return{solution:b(n),value:b(k),unconstrained_solution:b(d),iterations:b(B),iact:b(l),message:a}}})(numeric);
numeric.svd=function(a){function c(a,b){a=Math.abs(a);b=Math.abs(b);return a>b?a*Math.sqrt(1+b*b/a/a):0==b?a:b*Math.sqrt(1+a*a/b/b)}var b=numeric.epsilon;var d=1E-64/b,e=0,f=0,g=0,l=0,h=0;a=numeric.clone(a);var k=a.length,n=a[0].length;if(k<n)throw"Need more rows than columns";for(var p=Array(n),q=Array(n),f=0;f<n;f++)p[f]=q[f]=0;for(var r=numeric.rep([n,n],0),t=0,u=0,A=0,C=0,B=0,w=0,z=0,f=0;f<n;f++){p[f]=u;z=0;h=f+1;for(g=f;g<k;g++)z+=a[g][f]*a[g][f];if(z<=d)u=0;else for(t=a[f][f],u=Math.sqrt(z),
0<=t&&(u=-u),A=t*u-z,a[f][f]=t-u,g=h;g<n;g++){z=0;for(l=f;l<k;l++)z+=a[l][f]*a[l][g];t=z/A;for(l=f;l<k;l++)a[l][g]+=t*a[l][f]}q[f]=u;z=0;for(g=h;g<n;g++)z+=a[f][g]*a[f][g];if(z<=d)u=0;else{t=a[f][f+1];u=Math.sqrt(z);0<=t&&(u=-u);A=t*u-z;a[f][f+1]=t-u;for(g=h;g<n;g++)p[g]=a[f][g]/A;for(g=h;g<k;g++){z=0;for(l=h;l<n;l++)z+=a[g][l]*a[f][l];for(l=h;l<n;l++)a[g][l]+=z*p[l]}}B=Math.abs(q[f])+Math.abs(p[f]);B>C&&(C=B)}for(f=n-1;-1!=f;f+=-1){if(0!=u){A=u*a[f][f+1];for(g=h;g<n;g++)r[g][f]=a[f][g]/A;for(g=h;g<
n;g++){z=0;for(l=h;l<n;l++)z+=a[f][l]*r[l][g];for(l=h;l<n;l++)r[l][g]+=z*r[l][f]}}for(g=h;g<n;g++)r[f][g]=0,r[g][f]=0;r[f][f]=1;u=p[f];h=f}for(f=n-1;-1!=f;f+=-1){h=f+1;u=q[f];for(g=h;g<n;g++)a[f][g]=0;if(0!=u){A=a[f][f]*u;for(g=h;g<n;g++){z=0;for(l=h;l<k;l++)z+=a[l][f]*a[l][g];t=z/A;for(l=f;l<k;l++)a[l][g]+=t*a[l][f]}for(g=f;g<k;g++)a[g][f]/=u}else for(g=f;g<k;g++)a[g][f]=0;a[f][f]+=1}b*=C;for(l=n-1;-1!=l;l+=-1)for(d=0;50>d;d++){f=!1;for(h=l;-1!=h;h+=-1){if(Math.abs(p[h])<=b){f=!0;break}if(Math.abs(q[h-
1])<=b)break}if(!f)for(e=0,z=1,C=h-1,f=h;f<l+1;f++){t=z*p[f];p[f]*=e;if(Math.abs(t)<=b)break;u=q[f];A=c(t,u);q[f]=A;e=u/A;z=-t/A;for(g=0;g<k;g++)B=a[g][C],w=a[g][f],a[g][C]=B*e+w*z,a[g][f]=-B*z+w*e}w=q[l];if(h==l){if(0>w)for(q[l]=-w,g=0;g<n;g++)r[g][l]=-r[g][l];break}if(49<=d)throw"Error: no convergence.";C=q[h];B=q[l-1];u=p[l-1];A=p[l];t=((B-w)*(B+w)+(u-A)*(u+A))/(2*A*B);u=c(t,1);t=0>t?((C-w)*(C+w)+A*(B/(t-u)-A))/C:((C-w)*(C+w)+A*(B/(t+u)-A))/C;z=e=1;for(f=h+1;f<l+1;f++){u=p[f];B=q[f];A=z*u;u*=e;
w=c(t,A);p[f-1]=w;e=t/w;z=A/w;t=C*e+u*z;u=-C*z+u*e;A=B*z;B*=e;for(g=0;g<n;g++)C=r[g][f-1],w=r[g][f],r[g][f-1]=C*e+w*z,r[g][f]=-C*z+w*e;w=c(t,A);q[f-1]=w;e=t/w;z=A/w;t=e*u+z*B;C=-z*u+e*B;for(g=0;g<k;g++)B=a[g][f-1],w=a[g][f],a[g][f-1]=B*e+w*z,a[g][f]=-B*z+w*e}p[h]=0;p[l]=t;q[l]=C}for(f=0;f<q.length;f++)q[f]<b&&(q[f]=0);for(f=0;f<n;f++)for(g=f-1;0<=g;g--)if(q[g]<q[f]){e=q[g];q[g]=q[f];q[f]=e;for(l=0;l<a.length;l++)b=a[l][f],a[l][f]=a[l][g],a[l][g]=b;for(l=0;l<r.length;l++)b=r[l][f],r[l][f]=r[l][g],
r[l][g]=b;f=g}return{U:a,S:q,V:r}};var AccumulateCOO=function(){this.rows=[];this.cols=[];this.vals=[]};AccumulateCOO.prototype.add=function(a){a=numeric.ccsGather(a);this.rows.push(a[0]);this.cols.push(a[1]);this.vals.push(a[2])};AccumulateCOO.prototype.total=function(a,c){this.rows=flatten2D(this.rows);this.cols=flatten2D(this.cols);this.vals=flatten2D(this.vals);return numeric.ccsScatterShaped([this.rows,this.cols,this.vals],a,c)};"use sctrict";var BilerpEnergy=function(){};BilerpEnergy.A_Mat=function(a,c,b,d,e,f,g){a=(c.u-a.u)*(c.v-a.v);g=numeric.zeros([1,g]);g[0][b]=a;g[0][d]=-a;g[0][e]=-a;g[0][f]=a;return g};BilerpEnergy.B_Mat=function(a,c,b,d,e,f,g){var l=(c.u-a.u)*a.v+a.u*(c.v-a.v),h=c.u-a.u;a=c.v-a.v;g=numeric.zeros([1,g]);g[0][b]=l-h-a;g[0][d]=-l+h;g[0][e]=-l+a;g[0][f]=l;return g};
BilerpEnergy.C_Mat=function(a,c,b,d,e,f,g){c=a.u*a.v;var l=a.u;a=a.v;g=numeric.zeros([1,g]);g[0][b]=c-l-a+1;g[0][d]=-c+l;g[0][e]=-c+a;g[0][f]=c;return g};BilerpEnergy.bilerp_coeffMats=function(a,c,b,d,e,f,g){var l=BilerpEnergy.A_Mat(a,c,b,d,e,f,g),h=BilerpEnergy.B_Mat(a,c,b,d,e,f,g);a=BilerpEnergy.C_Mat(a,c,b,d,e,f,g);return[l,h,a]};
BilerpEnergy.E_ab=function(a,c,b,d,e){var f=b[0][0],g=b[0][1],l=b[1][0],h=b[1][1];b=lerp_UV((a+c)/2,f,g);var k=lerp_UV((a+c)/2,l,h),n=surrounding_pixels(b,d,e,"index");b=n[0];var p=n[1],q=n[2],r=n[3],n=surrounding_pixels(k,d,e,"index"),k=n[0],t=n[1],u=n[2],A=n[3],n=d*e,g=globalEdge_to_local(f,g,b,d,e),f=g[0],g=g[1];e=globalEdge_to_local(l,h,k,d,e);d=e[0];var C=e[1];e=BilerpEnergy.bilerp_coeffMats(f,g,0,1,2,3,8);f=e[0];h=e[1];l=e[2];e=BilerpEnergy.bilerp_coeffMats(d,C,4,5,6,7,8);C=e[1];g=e[2];d=function(b,
d){return numeric.div(b,d*(Math.pow(c,d)-Math.pow(a,d)))};e=numeric.sub(f,e[0]);var h=numeric.sub(h,C),B=numeric.sub(l,g),l=numeric.dot(numeric.transpose(e),e),f=numeric.dot(numeric.transpose(h),h),g=numeric.dot(numeric.transpose(B),B),C=numeric.dot(numeric.transpose(e),h);e=numeric.dot(numeric.transpose(e),B);h=numeric.dot(numeric.transpose(h),B);d=numeric.add(d(l,5),d(numeric.add(C,numeric.transpose(C)),4),d(numeric.add(e,numeric.transpose(e),f),3),d(numeric.add(h,numeric.transpose(h)),2),d(g,1));
b=[b,p,q,r,k,t,u,A];b=numeric.transpose(product(b,b));d=flatten2D(d);return numeric.ccsScatterShaped([b[0],b[1],d],n,n)};BilerpEnergy.E_edgePair=function(a,c,b,d){for(var e=compute_edgePair_intervals(a,c,b),f=c*b,g=new AccumulateCOO,l=0;l<e.length-1;l++)g.add(BilerpEnergy.E_ab(e[l],e[l+1],a,c,b));return numeric.ccsmul(g.total(f,f),d)};
BilerpEnergy.E_total=function(a,c,b,d,e){log_output("Building Bilinear Energy Matrix:");for(var f=c*b,g=new AccumulateCOO,l=0,h=0;h<a.length;h++){var k=a[h],n=e[h];print_progress(h/a.length);l+=n;g.add(BilerpEnergy.E_edgePair(k,c,b,n))}g=g.total(f,f);print_progress(1);return QuadEnergy(numeric.ccsdiv(g,l),numeric.ccsZeros(f,d),numeric.ccsZeros(d,d))};"use sctrict";var Dirichlet=function(){};
Dirichlet.grad_and_mass=function(a,c,b,d){print_progress(0);var e=c*(a-1),f=a*(c-1),g=numeric.ones([e+f]),g=numeric.mul(-1,g).concat(g);var l=numeric.range(a*c);l=numeric.mask(l,numeric.not(numeric.eq(numeric.mod(l,c),c-1)));var h=numeric.range(e).concat(l,numeric.range(c,e+c),numeric.add(l,1));void 0!==d?(l=flatten2D(numeric.and(numeric.slice(d,[":-1"]),numeric.slice(d,["1:"]))),l=l.concat(flatten2D(numeric.and(numeric.slice(d,[":",":-1"]),numeric.slice(d,[":","1:"])))),l=numeric.asNumbers(l)):l=
numeric.ones([e+f]);if(void 0!==b){d=numeric.zeros([a-1,c]);for(e=0;e<a-1;e++)for(f=0;f<c;f++)0<f&&b[e][f-1]&&b[e+1][f-1]&&(d[e,f]+=.125),f<c-1&&b[e][f+1]&&b[e+1][f+1]&&(d[e,f]+=.125);mass=flatten2D(d);d=numeric.zeros([a,c-1]);for(e=0;e<a;e++)for(f=0;f<c-1;f++)0<e&&b[e-1][f]&&b[e-1][f+1]&&(d[e,f]+=.125),e<a-1&&b[e+1][f]&&b[e+1][f+1]&&(d[e,f]+=.125);mass=mass.concat(flatten2D(d));d=flatten2D(numeric.and(numeric.slice(b,[":-1"]),numeric.slice(b,["1:"])));d=d.concat(flatten2D(numeric.and(numeric.slice(b,
[":",":-1"]),numeric.slice(b,[":","1:"]))));tiled_keep_rows=d.concat(d);g=numeric.mask(g,tiled_keep_rows);h=numeric.mask(h,tiled_keep_rows);l=numeric.mask(l,d);mass=numeric.mask(mass,d);b=numeric.sum(d)}else m=numeric.hstack([numeric.rep([a-1,1],.125),numeric.rep([a-1,c-2],.25),numeric.rep([a-1,1],.125)]),mass=flatten2D(m),m=numeric.vstack([numeric.rep([1,c-1],.125),numeric.rep([a-2,c-1],.25),numeric.rep([1,c-1],.125)]),mass=mass.concat(flatten2D(m)),b=e+f;rowI=numeric.range(b);rowI=rowI.concat(rowI);
G=numeric.ccsScatterShaped([rowI,h,g],b,a*c);M=numeric.ccsDiag(mass,b,b);S=numeric.ccsDiag(l,b,b);print_progress(1);return[G,M,S]};Dirichlet.gen_symmetric_grid_laplacian=function(a,c,b){G_M_S=Dirichlet.grad_and_mass(a,c,b);return numeric.ccsDot(numeric.ccsTranspose(G),numeric.ccsDot(M,G))};
Dirichlet.dirichlet_energy=function(a,c,b,d,e){a=Dirichlet.grad_and_mass(a,c,d,e);c=a[0];d=a[1];e=a[2];var f=numeric.ccsTranspose(c);a=numeric.ccsDot(f,numeric.ccsDot(d,c));c=numeric.ccsDot(f,numeric.ccsDot(e,numeric.ccsDot(d,c)));d=numeric.ccsSparseShaped(b);e=numeric.ccsTranspose(d);return new QuadEnergy(a,numeric.ccsmul(-1,numeric.ccsDot(c,d)),numeric.ccsDot(e,numeric.ccsDot(c,b)))};var FindSeam=function(){};FindSeam.edges_equal_in_UV=function(a,c,b){var d=[a.f[c[0]][c[1][0]],a.f[c[0]][c[1][1]]];c=d.map(function(b){return a.vt[b.vt]});d=[a.f[b[0]][b[1][1]],a.f[b[0]][b[1][0]]];b=d.map(function(b){return a.vt[b.vt]});return numeric.equal(c,b)};FindSeam.orientation=function(a,c,b){a=[[a[0]-b[0],a[1]-b[1]],[c[0]-b[0],c[1]-b[1]]];return a[0][0]*a[1][1]-a[0][1]*a[1][0]};
FindSeam.edge_is_foldover=function(a,c,b){var d=function(a){for(var b=[0,1,2],c=0;c<b.length;c++)if(0>a.indexOf(b[c]))return b[c];return-1},e=a.vt[a.f[c[0]][c[1][0]].vt],f=a.vt[a.f[c[0]][c[1][1]].vt];c=a.vt[a.f[c[0]][d(c[1])].vt];a=a.vt[a.f[b[0]][d(b[1])].vt];b=FindSeam.orientation(e,f,c);e=FindSeam.orientation(e,f,a);return 1E-8>Math.abs(Math.sign(b)-Math.sign(e))};
FindSeam.find_seam=function(a){for(var c=a.f.map(function(a){return a.map(function(a){return a.v})}),b=a.f.map(function(a){return a.map(function(a){return a.vt})}),d={},e=0;e<c.length;e++){var f=c[e];d[JSON.stringify([f[0],f[1]])]=[e,[0,1]];d[JSON.stringify([f[1],f[2]])]=[e,[1,2]];d[JSON.stringify([f[2],f[0]])]=[e,[2,0]]}f=Object.keys(d);c=new Set;for(e=0;e<f.length;e++){var g=JSON.parse(f[e]);c.add(JSON.stringify([Math.min(g[0],g[1]),Math.max(g[0],g[1])]))}for(var c=Array.from(c).map(JSON.parse),
f=[],g=[],l=[],e=0;e<c.length;e++){var h=c[e];if(d.hasOwnProperty(h)&&d.hasOwnProperty(h.slice().reverse())){var k=d[h],h=d[h.slice().reverse()];numeric.equal([b[k[0]][k[1][0]],b[k[0]][k[1][1]]],[b[h[0]][h[1][0]],b[h[0]][h[1][1]]].slice().reverse())||FindSeam.edges_equal_in_UV(a,k,h)?FindSeam.edge_is_foldover(a,k,h)&&l.push(k):f.push([k,h])}else d.hasOwnProperty(h)?g.push(d[h]):d.hasOwnProperty(h.slice().reverse())&&g.push(d[h.slice().reverse()])}return[f,g,l]};
FindSeam.seam_to_UV=function(a,c,b,d){c=c.map(function(b){return b.map(function(b){return b[1].map(function(c){return a.vt[a.f[b[0]][c].vt]})})});b=b.map(function(b){return b[1].map(function(c){return a.vt[a.f[b[0]][c].vt]})});d=d.map(function(b){return b[1].map(function(c){return a.vt[a.f[b[0]][c].vt]})});return[c,b,d]};var LSQConstraints=function(){};LSQConstraints.constrain_values=function(a,c){var b=numeric.dim(a),b=b[1]*b[0];numeric.dim(c);var d=numeric.asNumbers(flatten2D(a)),b=numeric.ccsDiag(d,b,b),d=numeric.ccsDot(b,numeric.ccsSparseShaped(c)),e=numeric.sum(a);0!==e&&(e=1/e);return QuadEnergy(numeric.ccsmul(e,b),numeric.ccsmul(-e,d),numeric.ccsmul(e,numeric.ccsDot(numeric.ccsTranspose(d),d)))};var Mask=function(){};Mask.get_all_surrounding_pixels=function(a,c,b){for(var d=new Set,e=0;e<a.length;e++){var f=a[e];UV_to_XY(f[0],c,b);UV_to_XY(f[1],c,b);for(var g=Array.from(compute_edge_intervals(f,c,b)).sort(),l=0;l<g.length-1;l++){var h=lerp_UV((g[l]+g[l+1])/2,f[0],f[1]);surrounding_pixels(h,c,b,"array").forEach(function(a){return d.add(JSON.stringify(a))})}}return Array.from(d).map(JSON.parse)};
Mask.mask_seam=function(a,c,b,d){var e=Mask.get_all_surrounding_pixels(c,b,d);a=numeric.ones([e.length]);c=numeric.slice(e,[":",1]);e=numeric.slice(e,[":",0]);b=numeric.ccsFull(numeric.ccsScatterShaped([c,e,a],d,b));return numeric.not(b)};
Mask.mask_inside_seam=function(a,c,b,d){var e=Mask.get_all_surrounding_pixels(c,b,d),f=a.f.map(function(c){return c.map(function(c){c=UV_to_XY(a.vt[c.vt],b,d);return[c.x,c.y]})});c=numeric.zeros([d,b]);for(var g=0;g<f.length;g++){var l=f[g];print_progress(g/f.length);var h=[Math.min.apply(Math,[].concat($jscomp.arrayFromIterable(numeric.slice(l,[":",0])))),Math.min.apply(Math,[].concat($jscomp.arrayFromIterable(numeric.slice(l,[":",1]))))],k=[Math.max.apply(Math,[].concat($jscomp.arrayFromIterable(numeric.slice(l,
[":",0])))),Math.max.apply(Math,[].concat($jscomp.arrayFromIterable(numeric.slice(l,[":",1]))))],h=numeric.all(numeric.and(numeric.leq(h,e),numeric.leq(e,k)),1),h=numeric.mask(e,h);if(0<h.length)for(l=points_in_triangle(l,h),k=0;k<h.length;k++)c[h[k][1]][h[k][0]]=c[h[k][1]][h[k][0]]||l[k]}f=numeric.ones([e.length]);g=numeric.slice(e,[":",1]);e=numeric.slice(e,[":",0]);e=numeric.ccsFull(numeric.ccsScatterShaped([g,e,f],d,b));c=numeric.sub(e,c);print_progress(1);return numeric.not(c)};
Mask.mask_inside_faces=function(a,c,b,d){var e=a.f.map(function(d){return d.map(function(d){d=UV_to_XY(a.vt[d.vt],c,b);return[d.x,d.y]})});void 0===d&&(d=numeric.zeros([b,c]));for(var f=0;f<e.length;f++){var g=e[f];print_progress(f/e.length);var l=[Math.min.apply(Math,[].concat($jscomp.arrayFromIterable(numeric.slice(g,[":",0])))),Math.min.apply(Math,[].concat($jscomp.arrayFromIterable(numeric.slice(g,[":",1]))))],h=[Math.max.apply(Math,[].concat($jscomp.arrayFromIterable(numeric.slice(g,[":",0])))),
Math.max.apply(Math,[].concat($jscomp.arrayFromIterable(numeric.slice(g,[":",1]))))],h=numeric.vstack([l,h]),l=numeric.range(Math.max(0,Math.floor(h[0][0])),Math.min(c,Math.ceil(h[1][0])+1)),h=numeric.range(Math.max(0,Math.floor(h[0][1])),Math.min(b,Math.ceil(h[1][1])+1)),l=product(l,h);if(0<l.length)for(g=points_in_triangle(g,l),h=0;h<l.length;h++)d[l[h][1]][l[h][0]]=d[l[h][1]][l[h][0]]||g[h]}print_progress(1);return numeric.not(d)};numeric.ccsZeros=function(a,c){return numeric.ccsScatter([[a-1],[c-1],[0]])};numeric.ccsScatterAdd=function(a){var c=a[0],b=a[1];a=a[2];for(var d=[],e=[],f=[],g={},l=0;l<c.length;l++){var h=g[[c[l],b[l]]];void 0===h?(g[[c[l],b[l]]]=d.length,d.push(c[l]),e.push(b[l]),f.push(a[l])):f[h]+=a[l]}return numeric.ccsScatter([d,e,f])};
numeric.ccsScatterShaped=function(a,c,b){if(void 0!==c&&void 0!==b){var d=a[0];var e=a[1];var f=a[2];if(0>d.indexOf(c-1)||0>e.indexOf(b-1))d.push(c-1),e.push(b-1),f.push(0)}return numeric.ccsScatterAdd([d,e,f])};numeric.ccsSparseShaped=function(a,c){void 0===c&&(c=numeric.dim(a));var b=numeric.ccsSparse(a);""+numeric.ccsDim(b)!==""+c&&(b[0][b[0].length-1]+=1,b[1].push(c[0]-1),b[2].push(0));return b};
numeric.ccsDiag=function(a,c,b){var d=numeric.range(a.length);return numeric.ccsScatterShaped([d,d,a],c,b)};numeric.ccsTranspose=function(a){a=numeric.ccsGather(a);return numeric.ccsScatter([a[1],a[0],a[2]])};numeric.equal=function(a,c,b){void 0===b&&(b=1E-8);return numeric.norm1(numeric.sub(a,c))<b};numeric.asNumbers=function(a){return a.map(Number)};
numeric.solveMatrix=function(a,c){for(var b=numeric.LU(a),d=numeric.dim(c),e=1<d.length?d[1]:1,f=void 0,g=0;g<e;g++)var l=numeric.LUsolve(b,numeric.slice(c,[":",g])),f=void 0===f?numeric.reshape(l,[d[0],1]):numeric.hstack([f,numeric.reshape(l,[d[0],1])]);return f};numeric.ccsGetCol=function(a,c){var b=numeric.ccsDim(a)[0],d=numeric.ccsGetBlock(a,void 0,c);d[0]=[0,b];0>d[1].indexOf(b-1)&&(d[1].push(b-1),d[2].push(0));return d};
numeric.ccsHStack=function(a,c,b,d,e){a=numeric.ccsGather(a);var f=numeric.ccsGather(c);c=a[0].concat(f[0]);var g=a[1].concat(numeric.add(d,f[1]));a=a[2].concat(f[2]);return numeric.ccsScatterShaped([c,g,a],b,d+e)};
numeric.ccsSolveMatrix=function(a,c){var b=!0,d=function(){b&&(console.log("."),setTimeout(d,100))};d();for(var e=numeric.ccsLUP(a),f=numeric.ccsDim(c),g=f[0],f=1<f.length?f[1]:1,l=void 0,h=0;h<f;h++)var k=numeric.ccsLUPSolve(e,numeric.ccsGetCol(c,h)),l=void 0===l?k:numeric.ccsHStack(l,k,g,h,1);b=!1;return l};var OBJ=function(a,c,b,d,e,f,g){return{v:a,vt:c,vn:b,vc:d,f:e,extra:f,filename:g}},FaceVertex=function(a,c,b){return{v:a,vt:c,vn:b}},OBJReader=function(){};
OBJReader.parse_obj=function(a,c){void 0===c&&(c="tmp.obj");for(var b=[],d=[],e=[],f=[],g=[],l=[],h=0;h<a.length;h++){var k=a[h].trim().split(" ").filter(function(a){return a});0!==k.length&&("v"===k[0]?(b.push(XYZ.apply(null,[].concat($jscomp.arrayFromIterable(k.slice(1,4).map(parseFloat))))),4<k.length&&f.push(k.slice(4).map(parseFloat))):"vt"===k[0]?d.push(UV.apply(null,[].concat($jscomp.arrayFromIterable(k.slice(1,3).map(parseFloat))))):"vn"===k[0]?e.push(XYZ.apply(null,[].concat($jscomp.arrayFromIterable(k.slice(1,
4).map(parseFloat))))):"f"===k[0]?g.push(k.slice(1).map(function(a){return FaceVertex.apply(null,[].concat($jscomp.arrayFromIterable((a+"//").split("/").slice(0,3).map(function(a){return 0<a.length?parseInt(a)-1:void 0}))))})):l.push(a[h].slice()))}return OBJ(b,d,e,f,g,l,c)};OBJReader.quads_to_triangles=function(a){for(var c=[],b=0;b<a.f.length;b++){var d=a.f[b];3!=d.length?(c.push([d[0],d[1],d[2]]),c.push([d[2],d[3],d[0]])):c.push(d)}a.f=c;return a};function points_in_triangle(a,c,b){void 0===b&&(b=1E-8);a=numeric.vstack([numeric.transpose(a),numeric.ones([1,3])]);if(1E-10>Math.abs(numeric.det(a)))return numeric.rep([npoints],!1);var d=c.length;c=numeric.vstack([numeric.transpose(c),numeric.ones([1,d])]);c=numeric.solveMatrix(a,c);return numeric.all(numeric.geq(c,-b),0)};var SeamGradient=function(){};SeamGradient.A_Mat=function(a,c,b,d,e,f,g){a=c[1]*(a[1].u-a[0].u)+c[0]*(a[1].v-a[0].v);g=numeric.zeros([1,g]);g[0][b]=a;g[0][d]=-a;g[0][e]=-a;g[0][f]=a;return g};SeamGradient.B_Mat=function(a,c,b,d,e,f,g){a=c[1]*a[0].u+c[0]*a[0].v;var l=c[0];c=c[1];g=numeric.zeros([1,g]);g[0][b]=a-l-c;g[0][d]=-a+l;g[0][e]=-a+c;g[0][f]=a;return g};
SeamGradient.inside_perpendicular_vector=function(a,c){var b=a.vt[a.f[c[0]][c[1][0]].vt],b=[b.u,b.v],d=a.vt[a.f[c[0]][c[1][1]].vt],d=[d.u,d.v],b=numeric.sub(d,b),d=a.f[c[0]].map(function(b){return a.vt[b.vt]}),b=is_counterclockwise.apply(null,[].concat($jscomp.arrayFromIterable(d)))?[-b[1],b[0]]:[b[1],-b[0]],d=numeric.norm2(b);return 1E-8<d?numeric.div(b,d):b};
SeamGradient.E_ab=function(a,c,b,d,e,f){var g=d.map(function(a){return a[1].map(function(c){return b.vt[b.f[a[0]][c].vt]})}),l=g[0][0],h=g[0][1],k=g[1][0],n=g[1][1],g=lerp_UV((a+c)/2,l,h),p=lerp_UV((a+c)/2,k,n),q=surrounding_pixels(g,e,f,"index"),g=q[0],r=q[1],t=q[2],u=q[3],q=surrounding_pixels(p,e,f,"index"),p=q[0],A=q[1],C=q[2],B=q[3],q=e*f,l=globalEdge_to_local(l,h,g,e,f),k=globalEdge_to_local(k,n,p,e,f);f=SeamGradient.inside_perpendicular_vector(b,d[0]);e=SeamGradient.A_Mat(l,f,0,1,2,3,8);f=SeamGradient.B_Mat(l,
f,0,1,2,3,8);d=SeamGradient.inside_perpendicular_vector(b,d[1]);l=SeamGradient.A_Mat(k,d,4,5,6,7,8);k=SeamGradient.B_Mat(k,d,4,5,6,7,8);d=function(b,d){return numeric.div(b,d*(Math.pow(c,d)-Math.pow(a,d)))};e=numeric.add(e,l);l=numeric.add(f,k);f=numeric.dot(numeric.transpose(e),e);k=numeric.dot(numeric.transpose(l),l);e=numeric.dot(numeric.transpose(e),l);d=numeric.add(d(f,3),d(numeric.add(e,numeric.transpose(e)),2),d(k,1));g=[g,r,t,u,p,A,C,B];g=numeric.transpose(product(g,g));d=flatten2D(d);return numeric.ccsScatterShaped([g[0],
g[1],d],q,q)};SeamGradient.E_edgePair=function(a,c,b,d,e){for(var f=c.map(function(b){return b[1].map(function(c){return a.vt[a.f[b[0]][c].vt]})}),f=compute_edgePair_intervals(f,b,d),g=b*d,l=new AccumulateCOO,h=0;h<f.length-1;h++)l.add(SeamGradient.E_ab(f[h],f[h+1],a,c,b,d));return numeric.ccsmul(l.total(g,g),e)};
SeamGradient.E_total=function(a,c,b,d,e,f){log_output("Building Seam Gradient Matrix:");for(var g=b*d,l=new AccumulateCOO,h=0,k=0;k<c.length;k++){var n=c[k],p=f[k];print_progress(k/c.length);h+=p;l.add(SeamGradient.E_edgePair(a,n,b,d,p))}l=l.total(g,g);print_progress(1);return QuadEnergy(numeric.ccsdiv(l,h),numeric.ccsZeros(g,e),numeric.ccsZeros(e,e))};function compute_edge_intervals(a,c,b){var d=new Set([0,1]),e=UV_to_XY(a[0],c,b);a=UV_to_XY(a[1],c,b);var f=a.x-e.x,g=a.y-e.y;range_min_max(Math.ceil(e.x),Math.ceil(a.x)).forEach(function(a){d.add(round((a-e.x)/f,10))});range_min_max(Math.ceil(e.y),Math.ceil(a.y)).forEach(function(a){d.add(round((a-e.y)/g,10))});return d}function compute_edgePair_intervals(a,c,b){for(var d=new Set,e=0;e<a.length;e++)compute_edge_intervals(a[e],c,b).forEach(function(a){d.add(a)});return Array.from(d).sort()}
function compute_seam_intervals(a,c,b){return a.map(function(a){return compute_edgePair_intervals(a,c,b)})};var SeamMinimizer=function(){},Energies=function(a,c,b,d,e){return{BLE:a,SV:c,SG:b,LSQ:d,L:e}},SeamValueMethod=function(){};SeamValueMethod.NONE=0;SeamValueMethod.TEXTURE=1;SeamValueMethod.LERP=2;SeamValueMethod.compute_energy=function(a,c,b,d,e,f){if(a===SeamValueMethod.NONE)log_output("=== Not using Seam Value Energy ===\n");else{if(a===SeamValueMethod.TEXTURE)return SVETexture.E_total(c,b,d,e,f);if(a===SeamValueMethod.LERP)return SVELerp.E_total(c,b,d,e)}};
function compute_seam_lengths(a,c){return c.map(function(b){var c=b[0][0],e=b[0][1][1];b=Object.values(a.v[a.f[c][b[0][1][0]].v]);c=Object.values(a.v[a.f[c][e].v]);return numeric.norm2(numeric.sub(c,b))})}
SeamMinimizer.compute_energies=function(a,c,b){void 0===b&&(b=SeamValueMethod.NONE);for(var d=numeric.dim(c),e=d[0],f=d[1],g=2<d.length?d[2]:1,d=[],l=0;l<c.length;l++)for(var h=0;h<c[l].length;h++)d.push(c[l][h]);log_output("Finding seam of model");c=FindSeam.find_seam(a);var l=c[0],h=c[1],k=c[2];c=FindSeam.seam_to_UV(a,l,h,k);var n=c[0],p=c[1],q=c[2];log_output("Done\n");log_output("Number of edges along the seam: "+2*l.length);log_output("Number of edges along the boundary: "+h.length);log_output("Number of foldover edges: "+
k.length+"\n");log_output("Computing seam edge lengths");var r=compute_seam_lengths(a,l);log_output("Done\n");c=BilerpEnergy.E_total(n,f,e,g,r);log_output("");g=SeamGradient.E_total(a,l,f,e,g,r);log_output("");var t=[];l.forEach(function(a){return a.forEach(function(a){return t.push(a)})});t=t.concat(h,k);b=SeamValueMethod.compute_energy(b,a,t,f,e,d);var u=[];n.forEach(function(a){return a.forEach(function(a){return u.push(a)})});u=u.concat(p,q);log_output("Building Least Squares Constraints:");h=
Mask.mask_inside_seam(a,u,f,e);l=LSQConstraints.constrain_values(h,d);log_output("");log_output("Building Dirichlet Energy Mask:");a=Mask.mask_inside_faces(a,f,e,numeric.not(h));log_output("\nBuilding Dirichlet Energy:");e=Dirichlet.dirichlet_energy(e,f,d,numeric.not(a),h);log_output("");return Energies(c,b,g,l,e)};
SeamMinimizer.solve_seam=function(a,c,b,d){void 0===b&&(b=SeamValueMethod.NONE);void 0===d&&(d=!1);var e=numeric.dim(c),f=2<e.length?e[2]:1,e=e[1]*e[0],g=SeamMinimizer.compute_energies(a,c,b);a=g.BLE;c=g.SV;b=g.SG;var l=g.LSQ,g=g.L;log_output("Solving for minimal energy solution");d=d?[1E10,100,100,100,1]:[1E10,100,100,1E4,1];for(var h=new AccumulateCOO,k=new AccumulateCOO,n=0;n<d.length;n++){var p=d[n],q=[a,c,b,l,g][n];void 0!==q&&(h.add(numeric.ccsmul(p,q.Q)),k.add(numeric.ccsmul(p,q.L)))}h=h.total(e,
e);k=k.total(e,f);f=numeric.ccsSolveMatrix(h,numeric.ccsmul(-1,k));log_output("Done\n");return numeric.ccsFull(f)};var SVELerp=function(){};
SVELerp.E_ab=function(a,c,b,d,e,f){var g=b.vt[b.f[d[0]][d[1][0]].vt],l=b.vt[b.f[d[0]][d[1][1]].vt],h=b.vc[b.f[d[0]][d[1][0]].v];b=b.vc[b.f[d[0]][d[1][1]].v];h=numeric.reshape(h,[1,h.length]);b=numeric.reshape(b,[1,b.length]);a=lerp_UV((a+c)/2,g,l);var k=surrounding_pixels(a,e,f,"index");a=k[0];c=k[1];d=k[2];var n=k[3],k=e*f;e=globalEdge_to_local(g,l,a,e,f);g=BilerpEnergy.bilerp_coeffMats(e[0],e[1],0,1,2,3,4);e=g[0];f=g[1];g=g[2];b=numeric.sub(b,h);values=numeric.add(term(numeric.dot(numeric.transpose(e),b),
4),term(numeric.add(numeric.dot(numeric.transpose(e),h),numeric.dot(numeric.transpose(f),b)),3),term(numeric.add(numeric.dot(numeric.transpose(f),h),numeric.dot(numeric.transpose(g),b)),2),term(numeric.dot(numeric.transpose(g),h),1));a=numeric.transpose(product([a,c,d,n],numeric.range(numeric.dim(h)[1])));rows=a[0];cols=a[1];a=numeric.ccsScatterShaped([rows,cols,values],k,numeric.dim(h)[1]);c=numeric.dot(numeric.transpose(b),h);values=numeric.add(term(numeric.dot(numeric.transpose(b),b),3),term(numeric.add(c,
numeric.transpose(c)),2),term(numeric.dot(numeric.transpose(h),h),1));g=numeric.ccsSparseShaped(values);return[Q,a,g]};
SVELerp.E_edge=function(a,c,b,d,e){for(var f=c[1].map(function(b){return a.vt[a.f[c[0]][b].vt]}),f=Array.from(compute_edge_intervals(f,b,d)).sort(),g=b*d,l=a.vc[0].length,h=new AccumulateCOO,k=new AccumulateCOO,n=new AccumulateCOO,p=0;p<f.length-1;p++){var q=E_ab(f[p],f[p+1],a,c,b,d);h.add(q[0]);k.add(q[1]);n.add(q[2])}h=numeric.ccsmul(e,h.total(g,g));k=numeric.ccsmul(e,k.total(g,l));n=numeric.ccsmuk(e,n.total(l,l));return[h,k,n]};
SVELerp.E_total=function(a,c,b,d){log_output("Building Seam Value of Lerp Energy Matrix:");if(len(a.vc)!=len(a.v))console.error("Mesh does not contain an equal number vertex colors and vertices.");else{for(var e=b*d,f=a.vc[0].length,g=new AccumulateCOO,l=new AccumulateCOO,h=new AccumulateCOO,k=0,n=0;n<c.length;n++){var p=c[n];print_progress(n/c.length);var q=p[1].map(function(b){return Object.values(a.v[a.f[p[0]][b].v])}),q=numeric.norm2(numeric.sub(q[1],q[0])),k=k+q,q=E_edge(a,p,b,d,q);g.add(q[0]);
l.add(q[1]);h.add(q[2])}g=numeric.ccsdiv(g.total(e,e),k);l=numeric.ccsdiv(l.total(e,f),k);h=numeric.ccsdic(h.total(f,f),k);print_progress(1);log_output("\n");return QuadEnergy(g,l,h)}};var SVETexture=function(){};
SVETexture.E_ab=function(a,c,b,d,e){var f=b[0],g=b[1];b=lerp_UV((a+c)/2,f,g);b=surrounding_pixels(b,d,e,"index");var l=b[0],h=b[1],k=b[2],n=b[3];b=d*e;d=globalEdge_to_local(f,g,l,d,e);d=BilerpEnergy.bilerp_coeffMats(d[0],d[1],0,1,2,3,4);var p=d[0],g=d[1],q=d[2];d=function(b,d){return numeric.div(b,d*(Math.pow(c,d)-Math.pow(a,d)))};e=numeeric.dot(numeric.transpose(p),p);var f=numeeric.dot(numeric.transpose(p),g),p=numeeric.dot(numeric.transpose(p),q),r=numeeric.dot(numeric.transpose(g),g),g=numeeric.dot(numeric.transpose(g),
q),q=numeeric.dot(numeric.transpose(q),q);d=numeric.add(d(e,5),d(numeric.add(f,numeric.transpose(f)),4),d(numeric.add(p,numeric.transpose(p),r),3),d(numeric.add(g,numeric.transpose(g)),2),d(q,1));l=[l,h,k,n,p00p,p10p,p01p,p11p];l=numeric.transpose(product(l,l));d=flatten2D(d);return numeric.ccsScatterShaped([l[0],l[1],d],b,b)};
SVETexture.E_edge=function(a,c,b,d){for(var e=Array.from(compute_edge_intervals(uv_edge,c,b)).sort(),f=c*b,g=new AccumulateCOO,l=0;l<e.length-1;l++)g.add(E_ab(e[l],e[l+1],a,c,b));g=g.total(f,f);return numeric.mul(g,d)};
SVETexture.E_total=function(a,c,b,d,e){log_output("Building Seam Value Energy Matrix:");for(var f=b*d,g=new AccumulateCOO,l=0,h=0;h<c.length;h++){var k=c[h];print_progress(h/float(len(c)));var n=a.f[k[0]],p=k[1].map(function(b){return Object.values(a.v[a.f[k[0]][b].v])}),p=numeric.norm2(numeric.sub(p[1],p[0])),l=l+p,q=k[1].map(function(b){return a.vt[n[b].vt]});g.add(E_edge(q,b,d,p))}g=g.total(f,f);print_progress(1);log_output("\n");c=numeric.ccsdiv(g,l);b=numeric.ccsSparseShaped(e);e=numeric.ccsmul(-1,
numeric.ccsDot(SV,b));b=numeric.ccsDot(numeric.ccsTranspose(b),numeric.ccsDot(SV,b));return QuadEnergy(c,e,b)};var UV=function(a,c){return{u:a,v:c}},Pixel=function(a,c){return{x:a,y:c}},XY=function(a,c){return{x:a,y:c}},XYZ=function(a,c,b){return{x:a,y:c,z:b}},QuadEnergy=function(a,c,b){return{Q:a,L:c,C:b}},flatten2D=function(a){return[].concat.apply([],a)},product=function(a){for(var c=[],b=0;b<arguments.length;++b)c[b-0]=arguments[b];return c.reduce(function(a,b){return flatten2D(a.map(function(a){return b.map(function(b){return[].concat($jscomp.arrayFromIterable(a),[b])})}))},[[]])};
function rowcol_to_index(a,c,b){return b*a+c}function lerp(a,c,b){return c+a*(b-c)}function lerp_UV(a,c,b){return UV(lerp(a,c.u,b.u),lerp(a,c.v,b.v))}function lerp_XY(a,c,b){return XY(lerp(a,c.x,b.x),lerp(a,c.y,b.y))}function UV_to_XY(a,c,b,d){a=XY(x=a.u*c-.5,y=a.v*b-.5);d&&(a=XY(x=Math.min(Math.max(0,a.x),Math.max(0,c-2)),y=Math.min(Math.max(0,a.y),Math.max(0,b-2))));return a}
function UVs_to_XYs(a,c,b){for(var d=0;d<a.length;d++)for(var e=0;e<a[d].length;e++)xyz.push(UV_to_XY(a[d][e],c,b));return[]}function globalUV_to_local(a,c,b,d,e){a=UV_to_XY(a,d,e);return UV(a.x-c,a.y-b)}function globalEdge_to_local(a,c,b,d,e){var f=b%d;b=Math.floor(b/d);return[globalUV_to_local(a,f,b,d,e),globalUV_to_local(c,f,b,d,e)]}
function surrounding_pixels(a,c,b,d){var e=UV_to_XY(a,c,b,!0);a=e.x;e=e.y;a=Math.floor(Math.min(Math.max(0,Math.floor(a)),c-1));var e=Math.floor(Math.min(Math.max(0,Math.floor(e)),b-1)),f=Pixel(a,e);a=Math.floor(Math.min(Math.max(0,Math.floor(a)+1),c-1));e=Math.floor(Math.min(Math.max(0,Math.floor(e)+1),b-1));b=Pixel(a,e);b=[f,Pixel(a=b.x,e=f.y),Pixel(a=f.x,e=b.y),b];return"index"===d?b.map(function(a){return rowcol_to_index(a.y,a.x,c)}):"array"===d?b.map(function(a){return[a.x,a.y]}):b}
function range_min_max(a,c){return numeric.range(Math.floor(Math.min(a,c)),Math.floor(Math.max(a,c)))}function round(a,c){return Number(a.toFixed(c))}function print_progress(a){a="\r"+round(100*a,2)+"%";log_output(a)}
function log_output(a,c){if(c)console.log(a);else if("undefined"!==typeof USING_WORKER)self.postMessage({id:"output",out_str:a});else{var b=document.getElementById("output");null!==b&&(""===b.innerHTML&&(b.innerHTML="<h3>Output:</h3>"),b.innerHTML+=a.replace("\n","<br>")+"<br>");console.log(a)}}function is_counterclockwise(a,c,b){return 0<numeric.det([[1,a[0],a[1]],[1,c[0],c[1]],[1,b[0],b[1]]])}function to_uint8(a){a=numeric.saturate(a);return a=numeric.round(numeric.mul(a,255))};var USING_WORKER=!0;function minimize(a,c){var b=OBJReader.quads_to_triangles(OBJReader.parse_obj(a.split("\n"),"")),d=numeric.dim(c).concat(1),e=d[0],d=d[1],f=dim[2],b=SeamMinimizer.solve_seam(b,c);console.log(numeric.reshape(b,[e,d,f]))}self.onmessage=function(a){"input"===a.data.id?minimize(a.data.objFile,JSON.parse(a.data.texture)):console.log(a)};